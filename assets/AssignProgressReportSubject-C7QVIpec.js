import{u as ae,c as p,ad as ne,r as i,kD as oe,t as ie,kE as X,kF as le,j as s,B as S,C as de,n as ce,G as I,o as k,E as F,I as R,J as E,K as xe,F as D,T as B,af as ue,ag as he,ah as be,ai as M,aj as x,he as W,ak as me,kG as ge}from"./index-CpZD2H93.js";import{Q as pe}from"./QuestionMark-B_7MKkiz.js";const u={padding:"0.2em 1.5em"},ye=()=>{const h=ae(),b=p(e=>e.AssignPrePrimaryGrades.listGradesDetails);p(e=>e.AssignPrePrimaryGrades.ISGetNonXseedStudentsName);const w=p(e=>e.AssignPrePrimaryGrades.IGetSaveNonXseedSubGradesMsg);p(e=>e.AssignPrePrimaryGrades.Loading);const z=ne(),{EditStatusId:c,ClassName:L,Assesment:Y,SelectTerm:m,SubjectName:V,SubjectId:v,StandardDivisionId:f,selectTeacher:G}=z.state||{},[H,J]=i.useState("0-0-0"),[l,T]=i.useState({}),[g,j]=i.useState({}),[C,P]=i.useState(""),[A,O]=i.useState(""),[$,Q]=i.useState(""),[K,U]=i.useState("");i.useEffect(()=>{h(oe(N))},[h]),i.useEffect(()=>{w!==""&&(ie.success(w),h(X(N))),h(le())},[w]);const d=p(e=>e.AssignPrePrimaryGrades.ISGetNonXseedStudentsObs);i.useEffect(()=>{h(X(N))},[]),i.useEffect(()=>{if(d.length>0){const e=d.reduce((r,t)=>(r[t.Text1]=se(t.Text3),r),{}),a=d.reduce((r,t)=>(r[t.Text1]=t.Text4,r),{});T(e),j(a),Q(JSON.stringify(e)),U(JSON.stringify(a))}},[d]);const _=(e,a,r)=>{J(e);const t=d.reduce((n,o)=>(n[o.Text1]=e,n),{});if(T(t),e==="0-0-0"||a==="1"||r==="1"){const n=d.reduce((o,y)=>(o[y.Text1]="",o),{});j(n)}},q=(e,a,r,t)=>{T(n=>({...n,[e]:a})),(a==="0-0-0"||r==="1"||t==="1")&&j(n=>({...n,[e]:""}))},Z=(e,a)=>{j(r=>({...r,[e]:a}))},N={asSchoolId:Number(localStorage.getItem("localSchoolId")),asAcademicYearId:Number(sessionStorage.getItem("AcademicYearId")),asStandardDivisionId:Number(f),asAssessmentId:Number(m),asSubjectId:Number(v)},ee=()=>{let e="";return d.forEach(a=>{var y;const r=a.Text5,t=a.Text1,n=(y=l[t])==null?void 0:y.split("-")[0],o=g[t];n!=="0"&&(e+="<NonXseedSubjectGrades><YearwiseStudentId>"+r+"</YearwiseStudentId><AssessmentId>"+m+"</AssessmentId><Observation>"+o+"</Observation><StandardDivisionId>"+f+"</StandardDivisionId><ShowSubjectRemark>false</ShowSubjectRemark><NonXseedSubjectGradeId>0</NonXseedSubjectGradeId><SubjectId>"+v+"</SubjectId><GradeId>"+n+"</GradeId></NonXseedSubjectGrades>")}),e=`<ArrayOfNonXseedSubjectGrades xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        ${e}</ArrayOfNonXseedSubjectGrades>`,e};function se(e){if(b.length>0)return(b==null?void 0:b.filter(r=>{var t;return((t=r.Value)==null?void 0:t.split("-")[0])===e}))[0].Value}const[Se,te]=i.useState(!1),re=()=>{P(""),O("");const e=Object.keys(l).filter(t=>{var o;const n=(o=l[t])==null?void 0:o.split("-");return l[t]!=="0-0-0"&&!g[t]&&n[1]!=="1"&&n[2]!=="1"}),a=Object.keys(l).filter(t=>l[t]=="0-0-0"&&!g[t]);te(a.length>0);const r={asXseedGradesXML:ee(),asSchoolId:Number(localStorage.getItem("localSchoolId")),asAcademicYearId:Number(sessionStorage.getItem("AcademicYearId")),asAssessmentId:Number(m),asStandardDivId:Number(f),asSubjectId:Number(v),asInsertedById:Number(sessionStorage.getItem("Id")),asUpdatedById:Number(sessionStorage.getItem("Id"))};if(e.length>0){P(`Observation should not be blank for row(s): ${e.toString()}`);return}else a.length===d.length?O("Fields should not be blank."):($!==JSON.stringify(l)||K!==JSON.stringify(g))&&h(ge(r))};return s.jsx(s.Fragment,{children:s.jsxs(S,{sx:{px:2},children:[s.jsx(de,{navLinks:[{title:G==="RP"?"Pre-Primary Progress Report Results":"Assign Pre-Primary Grades",path:G==="RP"?`/RITeSchool/Teacher/PrePrimaryResult/${m}/${f}`:"/RITeSchool/Teacher/AssignPrePrimaryGrades/"+m+"/"+G},{title:"Assign Subject Grades",path:""}],rightActions:s.jsx(s.Fragment,{children:s.jsxs(ce,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"left",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[s.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(k,{fullWidth:!0,label:"Class",value:L,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(k,{fullWidth:!0,label:"Assessment",value:Y,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(k,{fullWidth:!0,label:"Subject Name",value:V,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"}},size:"small",InputProps:{readOnly:!0}})}),s.jsxs(I,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:[c!=="3"&&c!=="3P"&&s.jsx(F,{title:"Save",children:s.jsx(R,{onClick:re,sx:{background:E[500],color:"white","&:hover":{backgroundColor:E[600]}},children:s.jsx(xe,{})})}),s.jsx(F,{title:'Assign grades to each student in the class for selected subject and click on " Save".',children:s.jsx(R,{sx:{color:"white",backgroundColor:D[500],height:"36px !important",":hover":{backgroundColor:D[600]}},children:s.jsx(pe,{})})})]})]})})}),c==="3"&&s.jsx(B,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:s.jsx("b",{children:"Student grades are already submitted."})}),c==="3P"&&s.jsx(B,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:s.jsx("b",{children:"Results for this assessment has been published. You need to unpublish the assessment to update the grades."})}),d.length===0?s.jsx("span",{}):s.jsxs(S,{sx:{background:"white",p:2},children:[A!==""&&s.jsx(S,{mb:1,children:s.jsx("div",{style:{color:"red",fontWeight:"bolder"},children:A})}),C!==""&&s.jsx(S,{mb:1,children:s.jsx("div",{style:{color:"red",fontWeight:"bolder"},children:C})}),s.jsx(ue,{component:S,children:s.jsxs(he,{"aria-label":"simple table",sx:{border:e=>`1px solid ${e.palette.divider}`},children:[s.jsx(be,{children:s.jsxs(M,{children:[s.jsx(x,{align:"center",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...u,pt:"15px",pb:"15px"},children:"Roll No."}),s.jsx(x,{align:"left",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...u,pt:"15px",pb:"15px"},children:"Student Name"}),s.jsx(x,{align:"right",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...u,pt:"15px",pb:"15px"},children:"Grade"}),s.jsx(x,{align:"left",sx:{textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...u},children:s.jsx(s.Fragment,{children:s.jsx(W,{sx:{maxWidth:"15vw",backgroundColor:"white"},ItemList:b,onChange:e=>_(e.Value,e.isAbsent,e.isExempted),label:"",disabled:c==="3"||c==="3P",defaultValue:H,size:"small",DisableClearable:!0})})}),s.jsx(x,{align:"center",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...u,pt:"15px",pb:"15px"},children:"Observations"})]})}),s.jsx(me,{children:d.length!==0&&d.map((e,a)=>{var r,t,n;return s.jsxs(M,{children:[s.jsx(x,{align:"center",sx:{...u},children:e.Text1}),s.jsx(x,{sx:{...u},children:e.Text2}),s.jsx(x,{align:"right",sx:{...u}}),s.jsx(x,{align:"left",sx:{...u},children:s.jsx(W,{sx:{width:"15vw",backgroundColor:"white"},ItemList:b,onChange:o=>q(e.Text1,o.Value,o.isAbsent,o.isExempted),label:"",disabled:c==="3"||c==="3P",defaultValue:l[e.Text1],DisableClearable:!0,size:"small"})}),s.jsx(x,{align:"center",sx:{...u},children:s.jsx("textarea",{rows:2,cols:50,style:{backgroundColor:"white"},disabled:c==="3"||c==="3P"||((r=l[e.Text1])==null?void 0:r.split("-")[0])==="0"||((t=l[e.Text1])==null?void 0:t.split("-")[1])==="1"?!0:((n=l[e.Text1])==null?void 0:n.split("-")[2])==="1",value:g[e.Text1],onChange:o=>Z(e.Text1,o.target.value),maxLength:500})})]},a)})})]})})]})]})})};export{ye as default};
