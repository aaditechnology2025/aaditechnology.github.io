import{j as e,B as l,T as Y,af as we,ag as Ce,ah as be,ai as X,aj as i,ak as De,E as u,I as f,ap as Te,aq as ve,A as Ae,j3 as Le,q as ke,v as Re,r as s,z as Ee,ct as R,t as q,lR as Oe,lS as E,lT as Be,C as He,n as Pe,G as S,bI as z,F as J,H as Fe,J as O,K as Me,ay as C,l as Ue,a7 as Ye,c7 as Q,av as $e,lU as Ve,lV as Ke,lW as Z}from"./index-CpZD2H93.js";import{d as We}from"./AddTwoTone-Dg32XyA0.js";import{d as _e}from"./PriorityHigh-GKb8m_z9.js";import{d as Ge}from"./ArrowCircleUp-C3u-oYJu.js";import{d as Xe}from"./Attachment-BXtOqCtF.js";import{h as ee}from"./moment-CaEEsv53.js";import{A as qe}from"./ArrowCircleDown-7BHmj5tB.js";import{L as ze}from"./Link-QB4wltBd.js";import{E as Je}from"./EditTwoTone-7ouzJGDn.js";import{y as te}from"./yellow-BQYah5ZS.js";import{R as Qe}from"./RadioGroup-DpIwLy2j.js";import{R as oe}from"./Radio-IVxzoZco.js";import"./FormGroup-C5-m8U5s.js";function Ze({ItemList:p,clickEdit:n,HeaderArray:d,toggleRowSelection:g,ClickHeader:b,clickDelete:c}){function D(o){const a=o.getDate().toString().padStart(2,"0"),H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()],x=o.getFullYear();return`${a}-${H}-${x}`}D(new Date);const B=o=>{const a=d.map(h=>h.Id===o?{...h,SortOrder:h.SortOrder==="desc"?"asc":"desc"}:{...h,SortOrder:null});b(a)};let j=localStorage.getItem("SiteURL")+"/RITeSchool/downloads/School Notices/",I=!1;return d.map(o=>{o.Id==6&&(I=!0)}),e.jsx(l,{sx:{},children:p.length===0?e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(Y,{variant:"h6",align:"center",color:"blue",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx(e.Fragment,{children:e.jsx(we,{component:l,children:e.jsxs(Ce,{"aria-label":"simple table",sx:{border:o=>`1px solid ${o.palette.divider}`},children:[e.jsx(be,{sx:{overflow:"auto"},children:e.jsxs(X,{sx:{background:o=>o.palette.secondary.main},children:[d.map((o,a)=>e.jsx(i,{sx:{color:h=>h.palette.common.white,textAlign:[1].includes(a)||[2,3,4,6].includes(a)?"left":"center",pt:1.5,pb:1.5},onClick:o.Id!==7&&o.Id!==8&&o.Id!==9?()=>B(o.Id):null,children:e.jsxs(l,{sx:{display:"flex",gap:.5},children:[e.jsx("b",{children:o.Header}),o.SortOrder!==null&&o.Id!==7&&o.Id!==8&&o.Id!==9?o.SortOrder==="desc"?e.jsx(Ge,{}):e.jsx(qe,{}):null]})},a))," ",e.jsx("span",{})]})}),e.jsx(De,{children:p.map((o,a)=>e.jsxs(X,{children:[e.jsx(i,{sx:{width:"220px",py:1},align:"left",children:o.Text1}),e.jsx(i,{sx:{width:"200px",py:1},align:"left",children:o.Text4}),e.jsx(i,{sx:{width:"300px",py:1},align:"left",children:ee(o.Text2).format("DD MMM YYYY   h:mm A")}),e.jsx(i,{sx:{width:"300px",py:1},align:"left",children:ee(o.Text3).format("DD MMM YYYY   h:mm A")}),e.jsx(i,{sx:{width:"150px"},align:"center",children:o.Text5}),I&&e.jsx(i,{sx:{width:"150px",py:1},align:"center",children:e.jsx(ze,{href:j+o.Text6,children:e.jsx(Xe,{})})}),e.jsx(i,{sx:{py:1},align:"center",children:e.jsx(u,{title:"Select notice to display under School Notices.",children:e.jsx("input",{type:"checkbox",style:{height:"18px",width:"18px"},checked:o.IsActive,onChange:()=>g(o.Id)})})}),e.jsx(i,{align:"center",sx:{py:1},children:e.jsx(u,{title:"Edit",children:e.jsx(f,{onClick:()=>n(o.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Je,{})})})}),e.jsx(i,{sx:{textTransform:"capitalize",opacity:1,py:1},align:"center",children:e.jsx(f,{sx:{color:"#223354","&:hover":{color:"red",backgroundColor:Te[100]}},onClick:()=>c(o.Id,o.Text2,o.Text3),children:e.jsx(u,{title:"Delete",children:e.jsx(ve,{})})})})]},a))})]})})})})}const mt=()=>{const p=Ae(),n=Le();let{selectDisplayT:d}=ke();d=Re(d);const g=Number(localStorage.getItem("localSchoolId"));Number(sessionStorage.getItem("AcademicYearId"));const b=Number(localStorage.getItem("UserId"));s.useState("AllFile");const[c,D]=s.useState("false"),[T,B]=s.useState("All");s.useState([]);const[j,I]=s.useState("true"),[o,a]=s.useState(!1),[h,H]=s.useState([]);s.useState("1");const[x,P]=s.useState(20),se=[20,50,100,200],[y,v]=s.useState(1),{showAlert:$,closeAlert:A}=s.useContext(Ee),[V,re]=s.useState("StartDate desc"),le=[{Id:1,Name:"File",Value:"false"},{Id:2,Name:"Text",Value:"true"}],ae=[{Id:1,Name:"All",Value:"All"},{Id:2,Name:"Both",Value:"Both"},{Id:3,Name:"Control Panel",Value:"Control Panel"},{Id:4,Name:"Home Page",Value:"Home Page"}],ne=R(t=>t.SchoolNotice.Loading),m=R(t=>t.SchoolNotice.SchoolNoticeList),[N,K]=s.useState([]);s.useEffect(()=>{K(m)},[m]);const F=R(t=>t.SchoolNotice.DeleteSchoolNoticeMsg),M=R(t=>t.SchoolNotice.SelectSchoolNotice),ce=m.filter(t=>t.RecordCount!==void 0).map(t=>t.RecordCount),w=[...new Set(ce)][0],L={asSchoolId:Number(g),asDisplayLocation:T,asShowAllNotices:j=="true",asText:o,asSortExpression:V,StartRowIndex:(y-1)*x,MaximumRows:y*x},ie=()=>{const t={asSchoolId:Number(g),asNoticeXml:Ie()};n(Ve(t)),n(E(L))};s.useEffect(()=>{d!==void 0&&D(d)},[]),s.useEffect(()=>{M!=""&&(q.success(M),n(Oe()),n(E(L)))},[M]);const de=(t,r,U)=>{const k={asSchoolId:g,asNoticeId:Number(t),asUpdatedById:Number(b)};Ke(r,U)?$({title:"Please Confirm",message:"This is an active notice. Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{A()},onConfirm:()=>{n(Z(k)),A()}}):$({title:"Please Confirm",message:"Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{A()},onConfirm:()=>{n(Z(k)),A()}})};s.useEffect(()=>{F!==""&&(q.success(F),n(Be()),n(E(L)))},[F]);let xe=[{Id:1,Header:"Link Name",SortOrder:null,sortKey:"NoticeName"},{Id:2,Header:"Display Location",SortOrder:null,sortKey:"DisplayLocation"},{Id:3,Header:"Start Date & Time",SortOrder:"desc",sortKey:"StartDate"},{Id:4,Header:"End Date & Time",SortOrder:null,sortKey:"EndDate"},{Id:5,Header:"Sort Order",SortOrder:null,sortKey:"dbSortOrder"},{Id:6,Header:"File Name",SortOrder:null,sortKey:"FileName"},{Id:7,Header:"Select"},{Id:8,Header:"Edit"},{Id:9,Header:"Delete"}];const[W,_]=s.useState([]);s.useEffect(()=>{let t=[];xe.map(r=>{c=="true"&&r.Id==6||t.push(r)}),_(t)},[c]);const he=t=>{_(t);const r=t.find(k=>k.SortOrder!==null),U=r?`${r.sortKey} ${r.SortOrder}`:"Created_Date desc";re(U)};s.useState(W),s.useEffect(()=>{},[c]);const ue=t=>{K(N.map(r=>({...r,IsActive:r.Id===t?!r.IsActive:r.IsActive})))},pe=t=>{d?p("../../AddSchoolNoticeFT/"+C(t)+"/"+C(c),{state:{fromInternal:!0}}):p("../AddSchoolNoticeFT/"+C(t)+"/"+C(c),{state:{fromInternal:!0}})},me=t=>{D(t),I("true"),P(20),v(1),c=="false"?a(!0):a(!1)},Se=t=>{B(t),P(20),v(1)},fe=t=>{I(t)},ge=t=>{v(t)},je=t=>{P(parseInt(t.target.value,10)),v(1)};s.useEffect(()=>{m&&H(m)},[m]);function Ie(){let t='<ArrayOfNoticeDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">';return N.map(r=>{t+=" <NoticeDetails><NoticeId> "+r.Id+"</NoticeId> <SortOrder>0</SortOrder><UserId>0</UserId><SortOrderLocationChanged>0</SortOrderLocationChanged><IsSelected>"+r.IsActive+"</IsSelected><IsText>"+o+"</IsText><InertedById>"+b+"</InertedById><SchoolId>0</SchoolId><AcademicYearId>0</AcademicYearId> <StandardDivisionId>0</StandardDivisionId> </NoticeDetails>"}),t+=`\r
</ArrayOfNoticeDetails>`,t}s.useEffect(()=>{n(E(L))},[y,x,j,c,T,V]);const ye=(y-1)*x+1,G=Math.min(y*x,w),Ne=Math.ceil(w/x);return e.jsxs(l,{sx:{px:2},children:[e.jsx(He,{navLinks:[{title:"School Notices",path:" "}],rightActions:e.jsxs(Pe,{direction:{xs:"column",sm:"row"},alignItems:"right",spacing:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(S,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(z,{sx:{minWidth:{xs:"40vw",sm:"13vw"}},ItemList:le,defaultValue:c,onChange:me,size:"small",label:" Display Type"})}),e.jsx(S,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(z,{sx:{minWidth:{xs:"40vw",sm:"13vw"}},ItemList:ae,defaultValue:T,onChange:Se,size:"small",label:"Display Location"})}),e.jsxs(S,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:[e.jsx(l,{children:e.jsx(u,{title:"Select the notices from the list to be displayed on School web site under School Notices.",children:e.jsx(f,{sx:{color:"white",backgroundColor:te[600],height:"36px !important",":hover":{backgroundColor:te[700]}},children:e.jsx(_e,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Displays all uploaded school notices.",children:e.jsx(f,{sx:{color:"white",backgroundColor:J[500],height:"36px !important",":hover":{backgroundColor:J[600]}},children:e.jsx(Fe,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Save",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],height:"36px !important",":hover":{backgroundColor:O[600]}},onClick:ie,children:e.jsx(Me,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Add New Notice",children:e.jsx(f,{onClick:()=>p("/RITeSchool/Teacher/AddSchoolNoticeFT/"+C(c),{state:{fromInternal:!0}}),sx:{color:"white",backgroundColor:O[500],"&:hover":{backgroundColor:O[600]}},children:e.jsx(We,{})})})})]})]})}),ne&&e.jsx(Ue,{}),e.jsx(S,{sx:{backgroundColor:"white",mb:2,p:1},children:e.jsx(S,{item:!0,sm:12,px:0,sx:{display:"flex",justifyItems:"center"},children:e.jsx(S,{children:e.jsx(Ye,{component:"fieldset",children:e.jsxs(Qe,{row:!0,"aria-label":"options",name:"options",value:j,onChange:t=>{fe(t.target.defaultValue)},children:[e.jsx(Q,{value:"true",control:e.jsx(oe,{}),label:"Show All Notices"}),e.jsx(Q,{value:"false",control:e.jsx(oe,{}),label:"Show Active Notices"})]})})})})}),e.jsxs(l,{sx:{background:"white",pt:2,p:2},children:[w>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(Y,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(l,{component:"span",fontWeight:"fontWeightBold",children:[ye," to ",G]})," ","out of"," ",e.jsx(l,{component:"span",fontWeight:"fontWeightBold",children:w})," ",w===1?"record":"records"]})}):e.jsx("span",{children:" "}),N&&N.length>0?e.jsx(Ze,{HeaderArray:W,ItemList:N,clickDelete:de,ClickHeader:he,toggleRowSelection:ue,clickEdit:pe}):e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(Y,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}),G>19?e.jsx($e,{rowsPerPage:x,ChangeRowsPerPage:je,rowsPerPageOptions:se,PageChange:ge,pagecount:Ne}):e.jsx("span",{})]})]})};export{mt as default};
