import{r as n,j as e,B as i,E as N,h as we,bj as Me,I as f,bJ as de,bK as Te,T,bM as De,n as W,G as M,q as Fe,v as ue,u as Le,A as Ye,h1 as Pe,c as G,h2 as Ne,h3 as xe,z as He,t as We,h4 as Be,C as $e,ay as Ee,bI as Ve,F as he,H as Oe,J as S,b2 as ze,a6 as b,a0 as J,a1 as U,a2 as X,a3 as q,a5 as K,ap as ge,K as _e,h5 as Re,h6 as Ge}from"./index-CpZD2H93.js";import{D as A}from"./DotLegendAttandaceCalender-CglCrcbT.js";import{C as Je}from"./Card-B0aZ7mGs.js";import"./CardStyle-CBuNm0_N.js";import"./DotLegendStyled-CQchpEqY.js";function Ue({item:a,clickItem:C,DefaultValue:j,options:y=void 0,legendColors:l}){const[D,v]=n.useState(!1);function d(g,r){let I=parseInt(g.slice(1,3),16),H=parseInt(g.slice(3,5),16),Y=parseInt(g.slice(5,7),16);return`rgba(${I}, ${H}, ${Y}, ${r})`}const x={p:d(l.p,.2),a:d(l.a,.2),h:d(l.h,.2),w:d(l.w,.2),o:d(l.o,.1),l:d(l.l,.2),n:d(l.n,.2)},h={heihgt:"15vh",fontSize:"20px"},F=()=>{(a.Text1==="Present"||a.Text1==="Absent")&&v(!0)},L=()=>{v(!1)},s=g=>{a.IsClickable&&C(g)},c=a.Text1!=null?a.Text1.split("")[0].toLowerCase():0;return e.jsx("div",{children:e.jsx(i,{py:0,my:0,sx:{backgroundColor:x[c],color:l[c],...h,fontWeight:"700",height:"10vh",cursor:D?"pointer":"default"},textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",onClick:()=>{s(a.Value)},onMouseEnter:F,onMouseLeave:L,children:e.jsx(N,{title:a.MouseoverStatus||"",children:e.jsx(i,{component:"span",dangerouslySetInnerHTML:{__html:a.Name}})})})})}function Xe({ItemList:a,ClickItem:C,handlePrevMonth:j,handleNextMonth:y,formattedDate:l,DefaultValue:D,ArrayList:v}){const d={p:"#008000",a:"#9e9e9e",h:"#751b1b",w:"#ff0000",o:"#f06292",l:"#303f9f",n:"#FCCF31"},x=we(),h=Me(x.breakpoints.down("sm")),F=s=>{const c=r=>(r.Status==null?r.Text3:r.Status)=="Y";let g=a.map(r=>r.Value===s?{...r,Status:c(r)?"N":"Y",BackgroundColor:c(r)?"tomato":"mediumturquoise",Text1:c(r)?"Absent":"Present"}:r);C(g)};let L=new Date("01"+l).getDay();return e.jsx(i,{sx:{backgroundColor:"white",p:2},children:e.jsxs(i,{sx:{alignItems:"center",justifyContent:"center",textAlign:"center","& > .MuiIconButton-root":{margin:"0 2px"}},children:[e.jsxs(i,{display:"flex",alignItems:"center",children:[e.jsx(f,{color:"primary",sx:{backgroundColor:s=>de(s.palette.primary.main,.2),marginRight:"8px"},onClick:j,children:e.jsx(Te,{fontSize:h?"small":"medium"})}),e.jsx(T,{m:0,variant:"h3",sx:{fontSize:h?"1.2rem":"2rem",fontWeight:"bold",textAlign:"center"},children:l}),e.jsx(f,{color:"primary",sx:{backgroundColor:s=>de(s.palette.primary.main,.2),marginLeft:"8px"},onClick:y,children:e.jsx(De,{fontSize:h?"small":"medium"})}),e.jsx(W,{direction:"row",gap:1,sx:{display:h?"none":"flex"}})]}),e.jsxs(M,{container:!0,spacing:0,sx:{mt:2,overflow:"auto"},children:[v.map((s,c)=>e.jsx(M,{item:!0,xs:1.7,md:1.7,sx:{textAlign:"center"},children:e.jsx(i,{children:e.jsx(T,{sx:{textTransform:"capitalize",textAlign:"center",fontWeight:"bold"},children:s.Header})})},c)),e.jsx(M,{item:!0,xs:1.5*L,md:1.7*L,sx:{textAlign:"center",pt:0}}),a&&a.length>0&&a.map((s,c)=>e.jsx(M,{item:!0,xs:1.5,md:1.7,sx:{textAlign:"center",border:g=>`1px solid ${g.palette.grey[300]}`},children:e.jsx(Ue,{item:s,clickItem:F,DefaultValue:D,legendColors:d})},c))]}),e.jsx(M,{container:!0,sx:{mt:2},children:e.jsxs(M,{item:!0,xs:12,sx:{display:"flex",flexWrap:"wrap",gap:2},children:[e.jsx(A,{color:"primary",text:"Present"}),e.jsx(A,{color:"info",text:"Absent"}),e.jsx(A,{color:"Holiday",text:"Holiday"}),e.jsx(A,{color:"Warning",text:"Weekend"}),e.jsx(A,{color:"Suceess",text:"Outside Academic Year"}),e.jsx(A,{color:"LateJoin",text:"Late Join"}),e.jsx(A,{color:"NotAvailable",text:"Attendance Unavailable"})]})})]})})}const nt=()=>{var ie;let{selectClasstecahernew:a,AssignedDate:C}=Fe();C=ue(C),a=ue(a);const j=Le();Ye(),Pe(),n.useState(!0);const y=Number(localStorage.getItem("localSchoolId")),l=Number(sessionStorage.getItem("AcademicYearId")),D=Number(sessionStorage.getItem("TeacherId"));sessionStorage.getItem("StudentId"),n.useState();const[v,d]=n.useState(new Date().getFullYear()),[x,h]=n.useState([]),[F,L]=n.useState(null),[s,c]=n.useState(a||void 0);n.useState("");const[g,r]=n.useState(0),[I,H]=n.useState(new Date(C)),Y=t=>`${t.toLocaleString("default",{month:"short"})} ${t.getFullYear()}`,[p,Q]=n.useState(Y(I));`${I.toLocaleString("default",{month:"short"})}${I.getFullYear()}`;const me={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},[qe,Z]=n.useState(!1),ee=t=>{const m=t.split(" ")[0];return me[m]},[B,$]=n.useState(p?(ie=ee(p))==null?void 0:ie.toString():void 0),u=G(t=>t.IndividualAttendance.GetStudentName);console.log(u,"StudentList");const te=G(t=>t.IndividualAttendance.GetCalendarForStudent),E=G(t=>t.IndividualAttendance.SaveStudentAttendance),pe={asSchoolId:y,asAcademicYrId:l,asDivisionId:a!==void 0?Number(a):u&&u.length>0?Number(u[0].Value):null},ne={asSchoolId:y,aStudentId:Number(s),aAcademicYearId:l,aMonthId:Number(B),aYear:new Date(p).getFullYear()};n.useEffect(()=>{var t;p&&$((t=ee(p))==null?void 0:t.toString())},[p]);const fe=[{Id:1,Header:"Sun"},{Id:2,Header:"Mon"},{Id:3,Header:"Tue"},{Id:4,Header:"Wed"},{Id:5,Header:"Thu"},{Id:6,Header:"Fri"},{Id:7,Header:"Sat"}];n.useEffect(()=>{j(Ne(pe))},[]),n.useEffect(()=>{u&&u.length>0&&c(a||u[0].Value)},[u,a]),n.useEffect(()=>{s!="0"&&j(xe(ne))},[B,s]),n.useEffect(()=>{h(te)},[te]),n.useEffect(()=>{u.length>0&&c(u[0].Value)},[u]);const Ce=t=>{r(0),c(t)},ae=t=>{h(x.map(o=>o.IsClickable?{...o,Status:t,BackgroundColor:Ge(t),Text1:t=="Y"?"Present":"Absent"}:o));const m=x.some(o=>o.IsClickable&&o.Status!==t);Z(m),r(t)};n.useEffect(()=>{x.length>=0&&Ae(Ie())},[x]);const je=()=>{const t=new Date(p);t.setMonth(t.getMonth()-1),t.getMonth()===11&&t.setFullYear(t.getFullYear());const m=Y(t);H(t),$(`${t.getMonth()+1}`),d(t.getFullYear()),Q(m)},Se=()=>{const t=new Date(p);t.setMonth(t.getMonth()+1),t.getMonth()===0&&t.setFullYear(t.getFullYear());const m=Y(t);H(t),$(`${t.getMonth()+1}`),d(t.getFullYear()),Q(m)},[be,Ae]=n.useState(""),ye=t=>{h(t)},ve=n.useRef(null),[V,se]=n.useState(!1),[O,re]=n.useState(!1),[P,z]=n.useState(!1),{showAlert:_,closeAlert:k}=n.useContext(He),oe=()=>{_({title:"Save Changes",message:"Are you sure, Do you want to update changes?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{ke(),k()},onCancel:k})},le=()=>{_({title:"Mark all as Present",message:"Are you sure you want the chosen student to be marked as present on each day?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{ae("Y"),k()},onCancel:k})},R=()=>{_({title:"Mark all as Absent",message:"Are you sure you want the chosen student to be marked as absent on each day?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{ae("N"),k()},onCancel:k})},Ie=()=>{var t="";let m=!1;return x.map(o=>{o.Status!=null&&o.Status!=o.Text3&&(m=!0),o.IsClickable&&(t=t+'<SchoolWiseAttendance Attendance_Date="'+o.Value+'" Is_Present="'+(o.Status!=null?o.Status:o.Text3)+'" />')}),Z(m),"<Attendance>"+t+"</Attendance>"};n.useEffect(()=>{E!==""&&We.success(E,{toastId:"success1"}),j(Be()),j(xe(ne))},[E]);const ke=()=>{const t={asSchoolId:y,asInsertedById:D,asStudentsAttendance:be,aStudentId:Number(s),aYear:v,aMonthId:Number(B)};j(Re(t))},ce=new Date;ce.setHours(0,0,0,0);const w=I>ce;return e.jsxs(i,{sx:{px:2},children:[e.jsx($e,{navLinks:[{title:"Attendance",path:"/RITeSchool/Teacher/TAttendance/"+a+"/"+Ee(C)},{title:"Individual Attendance",path:"/RITeSchool/Teacher/TAttendance/IndividualAttendance"}],rightActions:e.jsx(e.Fragment,{children:e.jsx(W,{direction:{xs:"row",sm:"row"},gap:1,alignItems:"center",justifyContent:"flex-end",sx:{width:"100%",flexWrap:{xs:"nowrap",sm:"nowrap"}},children:e.jsxs(W,{direction:{xs:"row",sm:"row"},gap:1,alignItems:"center",justifyContent:"flex-start",sx:{width:"100%",flexWrap:{xs:"wrap",sm:"nowrap"}},children:[e.jsx(i,{sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(Ve,{sx:{minWidth:{xs:"200px",sm:"250px",md:"250px",lg:"350px",xl:"350px"}},ItemList:u,onChange:Ce,defaultValue:s,size:"small"})}),e.jsx(N,{title:"Mark monthly attendance of an individual student.",children:e.jsx(f,{sx:{color:"white",backgroundColor:he[500],height:"36px !important",":hover":{backgroundColor:he[600]}},children:e.jsx(Oe,{})})}),e.jsx(N,{title:"Present All",children:e.jsx(f,{onClick:le,disabled:w,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:S[500],":hover":{backgroundColor:S[600]},...w&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx("h5",{children:"P"})})}),e.jsx(ze,{disableScrollLock:!0,anchorEl:ve.current,onClose:()=>z(!P),open:P,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},children:e.jsx(Je,{sx:{py:5},children:e.jsxs(i,{width:400,gap:5,alignContent:"center",mx:2,children:[e.jsx(T,{color:"",mb:3,textAlign:"center",children:"Are you sure you want the chosen student to be marked as absent on each day?"}),e.jsxs(W,{direction:"row",gap:7,mx:5,justifyContent:"space-between",children:[e.jsx(b,{variant:"outlined",sx:{px:6},color:"error",onClick:R,children:"Cancel"}),e.jsx(b,{variant:"contained",sx:{px:6,backgroundColor:S[600],color:"white"},color:"primary",children:"Confirm"})]})]})})}),e.jsxs(J,{onClose:()=>z(!P),open:P,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(U,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["Mark all as Absent",e.jsx(f,{onClick:()=>{z(!P)},children:e.jsx(X,{})})]}),e.jsx(q,{dividers:!0,children:e.jsx(i,{py:2,children:e.jsx(T,{variant:"h4",textAlign:"center",children:"Are you sure you want the chosen student to be marked as absent on each day?"})})}),e.jsxs(K,{sx:{px:3,py:2},children:[e.jsx(b,{variant:"outlined",color:"error",onClick:R,children:"Cancel"}),e.jsx(b,{variant:"contained",sx:{backgroundColor:S[600],color:"white"},children:"Confirm"})]})]}),e.jsx(N,{title:"Absent All",children:e.jsx(f,{onClick:R,disabled:w,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:ge[500],":hover":{backgroundColor:ge[600]},...w&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx("h5",{children:"A"})})}),e.jsxs(J,{onClose:()=>se(!V),open:V,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(U,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["Save Changes",e.jsx(f,{onClick:()=>{se(!V)},children:e.jsx(X,{})})]}),e.jsx(q,{dividers:!0,children:e.jsx(i,{py:2,children:e.jsx(T,{variant:"h4",textAlign:"center",children:"Are you sure, Do you want to update changes?"})})}),e.jsxs(K,{sx:{py:2,px:3},children:[e.jsx(b,{variant:"outlined",color:"error",onClick:oe,children:"Cancel"}),e.jsx(b,{variant:"contained",sx:{backgroundColor:S[600],color:"white"},children:"Update"})]})]}),e.jsx(N,{title:"Save",children:e.jsx(f,{onClick:oe,disabled:w,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:S[500],":hover":{backgroundColor:S[600]},...w&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx(_e,{})})})]})})})}),e.jsx(i,{children:e.jsx(Xe,{ItemList:x,ClickItem:ye,handlePrevMonth:je,handleNextMonth:Se,formattedDate:p,DefaultValue:F,ArrayList:fe})}),e.jsxs(J,{onClose:()=>re(!O),open:O,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(U,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},color:"success",children:["Mark all as Present",e.jsx(f,{onClick:()=>{re(!O)},children:e.jsx(X,{})})]}),e.jsx(q,{dividers:!0,children:e.jsx(i,{py:2,children:e.jsx(T,{variant:"h4",textAlign:"center",children:"Are you sure you want the chosen student to be marked as present on each day?"})})}),e.jsxs(K,{sx:{px:3,py:2},children:[e.jsx(b,{variant:"outlined",color:"error",onClick:le,children:"Cancel"}),e.jsx(b,{variant:"contained",sx:{backgroundColor:S[600],color:"white"},children:"Confirm"})]})]})]})};export{nt as default};
