import{u as z,r as a,c as g,dt as O,j as t,B as E,l as $,b3 as H,t as q,du as J,dv as K}from"./index-CpZD2H93.js";import{d as Q}from"./Delete--TAmn0eZ.js";import{d as V}from"./KeyboardArrowUpRounded-Du3Qe5yI.js";import{d as W}from"./Replay-By_7bx7o.js";import{M as X}from"./MoveToTrash-BFwWcvGU.js";import{E as Z}from"./ErrorMessages-Cl09dz4o.js";import{L as ee}from"./List3-8A7pHBvM.js";import{B as R}from"./ButtonStyle-DAEB_dBE.js";import"./CheckboxImg-BrcA302U.js";import"./RadioButtonUnchecked-r_6mn_G1.js";const te=2;function fe(){const m=z(),[u,C]=a.useState(te),[n,y]=a.useState(),[s,se]=a.useState([]),[k,I]=a.useState("none"),[D,w]=a.useState(!1),i=g(e=>e.InboxMessage.InboxList),A=g(e=>e.InboxMessage.Loading),L=g(e=>e.InboxMessage.FilterData);i!=null&&(s.length==0&&D==!1&&i.forEach(e=>{e!=null&&s.push(e)}),L==!0?s.length!=0&&i.length!=0?(s.length=0,i.forEach(e=>{e!=null&&s.push(e)})):s.length=0:n!=null&&s.length!=0&&D==!0&&n.GetMessagesResult!=null&&n.GetMessagesResult.length!=0&&n.GetMessagesResult[0].DetailsId!=s[0].DetailsId&&n.GetMessagesResult.forEach(e=>{e!=null&&s.push(e)}));const p=localStorage.getItem("localSchoolId"),v=sessionStorage.getItem("Id"),S=sessionStorage.getItem("RoleId"),b=sessionStorage.getItem("AcademicYearId"),M={asUserId:v,asAcademicYearId:b,asUserRoleId:S,asSchoolId:p,abIsSMSCenter:"0",asFilter:"",asPageIndex:1,asMonthId:"0",asOperator:"",asDate:"",asSortExp:"Insert_Date",asSortDirection:"DESC"};a.useEffect(()=>{m(O(M))},[]);const[F,x]=a.useState(!0),[c,l]=a.useState({DetailInfo:[],recieverInfo:[]}),P=window.location.pathname.replace("/RITeSchool/MessageCenter/msgCenter/",""),U=e=>{x(!0);const{value:o,name:d,checked:f}=e,{DetailInfo:j,recieverInfo:T}=c;l(f?{DetailInfo:[...j,o],recieverInfo:[...T,d]}:{DetailInfo:j.filter(h=>h!==o),recieverInfo:T.filter(h=>h!==d)})},B=()=>{const e=c.DetailInfo.join(";"),o=c.recieverInfo.join(";"),d={asSchoolId:p,asMessageRecieverDetailsId:o,asMessageDetailsId:e,asIsArchive:"Y",asIsCompeteDelete:0,asFlag:"Inbox"};X.MoveToTrash(d).then(f=>{P=="Inbox"&&(q.success("Message has been moved to the trash."),m(J(M))),x(!1),l({DetailInfo:[],recieverInfo:[]})}).catch(f=>{alert("error network")})},G=()=>{x(!1),l({DetailInfo:[],recieverInfo:[]})},r=document.getElementById("ScrollableDiv"),N=()=>{C(u+1)},Y=()=>{if(r.scrollTop>=400&&I("flex"),r.scrollTop<400&&I("none"),r.scrollHeight-r.scrollTop<=570){w(!0);const e={asUserId:v,asAcademicYearId:b,asUserRoleId:S,asSchoolId:p,abIsSMSCenter:"0",asFilter:"",asPageIndex:u,asMonthId:"0",asOperator:"",asDate:"",asSortExp:"Insert_Date",asSortDirection:"DESC"};K.GetInboxList(e).then(o=>{y(o.data)}).catch(o=>{alert("error network")}),N()}},_=e=>{r.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{I("none")},10)};return t.jsxs(t.Fragment,{children:[c.DetailInfo.length!==0?t.jsxs(t.Fragment,{children:[t.jsx(E,{sx:{px:2},children:t.jsxs(E,{display:"flex",flexDirection:"row",justifyContent:"flex-end",children:[t.jsx(R,{color:"primary",endIcon:t.jsx(Q,{}),onClick:()=>B(),children:"DELETE"}),"  ",t.jsx(R,{color:"secondary",endIcon:t.jsx(W,{}),onClick:()=>G(),children:"RESET"})]})}),t.jsx("br",{})]}):null,t.jsxs("div",{id:"ScrollableDiv",onScroll:Y,style:{position:"absolute",width:"100%",paddingBottom:"100px",height:"570px",overflow:"auto"},children:[A?t.jsx($,{}):s===null||s.length==0||s==null?t.jsx(Z,{Error:"No message found"}):t.jsx(t.Fragment,{children:s.map((e,o)=>t.jsx(ee,{data:e,handleChange:U,check:F,Attachments:e.Attachment,FromRoute:"/Inbox"},o))}),t.jsx(H,{sx:{display:k,position:"fixed",bottom:"95px",zIndex:"4",left:"15px",p:"2px",width:50,height:50,backgroundColor:"white",boxShadow:"5px 5px 10px rgba(163, 177, 198, 0.4), -5px -5px 10px rgba(255, 255, 255, 0.3) !important"},onClick:_,children:t.jsx(V,{fontSize:"large",color:"success"})})]})]})}export{fe as default};
