import{cc as H,j as e,u as De,A as ge,q as Se,v as f,r as a,c as u,mY as fe,mZ as Ee,m_ as Ie,m$ as Le,t as ye,n0 as be,E,I,F as C,H as Te,B as L,ap as F,J as V,C as Re,c1 as ke,L as we,M as Ae,N as Ne,T as Be,O as Ce,Q as U,G as n,o as z,aH as s,bI as Fe,bs as P,az as G,n1 as O}from"./index-CpZD2H93.js";import{D as $}from"./DatepickerLeave-BYciAoLF.js";const Ve=H(e.jsx("path",{fillRule:"evenodd",d:"m9 17 3-2.94c-.39-.04-.68-.06-1-.06-2.67 0-8 1.34-8 4v2h9l-3-3zm2-5c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m4.47 8.5L12 17l1.4-1.41 2.07 2.08 5.13-5.17 1.4 1.41z"}),"HowToReg"),Ue=H(e.jsx("path",{d:"M14 8c0-2.21-1.79-4-4-4S6 5.79 6 8s1.79 4 4 4 4-1.79 4-4zm3 2v2h6v-2h-6zM2 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4z"}),"PersonRemove"),Qe=()=>{const l=De(),W=ge();let{LeaveDId:o,selectCategory:x,getSenderName:m}=Se();o=f(o),x=f(x),m=f(m);const c=Number(localStorage.getItem("localSchoolId")),y=sessionStorage.getItem("AcademicYearId"),h=Number(localStorage.getItem("UserId")),Y=sessionStorage.getItem("StudentName"),[i,M]=a.useState(Number(localStorage.getItem("UserId"))),[ze,_]=a.useState(i==null?"0":Y),[j,b]=a.useState(new Date().toISOString().split("T")[0]),[D,T]=a.useState(new Date().toISOString().split("T")[0]),[q,R]=a.useState(""),[J,k]=a.useState("0"),[Q,Pe]=a.useState(" "),[Z,w]=a.useState(""),[p,A]=a.useState(""),[K,v]=a.useState(""),[X,Ge]=a.useState(""),[ee,Oe]=a.useState(""),[te,$e]=a.useState(""),[ae,He]=a.useState(""),[re,We]=a.useState(""),[se,Ye]=a.useState(""),[oe,Me]=a.useState(""),[ne,_e]=a.useState(""),r=u(t=>t.LeaveDetails.ViewLeaveDetails),le=u(t=>t.AddLeaveDetails.LeaveTypeDropdown),N=u(t=>t.AddLeaveDetails.LeaveBalanceNote);u(t=>t.AddLeaveDetails.SubmitLeave),u(t=>t.AddLeaveDetails.StartDateEndDateValidations);const g=u(t=>t.AddLeaveDetails.ApproveorReject),ce=[" If leave start date or end date is across the month, then the system will update leave for only the days that are in the upcoming salary publish month."];a.useEffect(()=>{if(o!=null&&r.length>0&&r[0]!=null){const t=r[0];_(t.Text1),b(t.Text2),T(t.Text3),R(t.Text4),k(t.LeaveType),w(t.Text5),M(t.UserId),A(t.Text6)}},[r]),a.useEffect(()=>{if(o){const t={asSchoolId:c,asUserId:i,asId:Number(o)};l(fe(t))}},[o]);const ie=N.map((t,d)=>c===122?d===0||d===N.length-1?`${t.Text1} (${t.Text2})`:`${t.Text1} (Unpaid)`:`${t.Text1} (${t.Text2})`).join(", "),de={asSchoolId:c};a.useEffect(()=>{l(Ee(de))},[]),a.useEffect(()=>{i&&l(Ie({asSchoolId:c,asUserId:i}))},[i]),a.useEffect(()=>{l(Le({asSchoolId:c,aasStartDate:j,aasEndDate:D,asUserId:i,asLeaveConfigId:0}))},[j,D]);const ue=t=>{b(G(t))},pe=t=>{T(G(t))},xe=t=>{k(t)};a.useEffect(()=>{g!==""&&(ye.success(g),l(be()),W("/RITeSchool/Teacher/LeaveDetails",{state:{fromInternal:!0}}))},[g]);const he=()=>{let t=!1;if(p===""?(v("Remark should not blank."),t=!0):v(""),!t){const d={asId:0,asUserLeaveDetailsId:Number(o),asReportingUserId:h,asRemark:p,asstatusId:3,asSchoolId:c,asAcademicYearId:Number(y),asInsertedById:h};l(O(d))}},ve=()=>{let t=!1;if(p===""?(v("Remark should not blank."),t=!0):v(""),!t){const d={asId:0,asUserLeaveDetailsId:Number(o),asReportingUserId:h,asRemark:p,asstatusId:4,asSchoolId:c,asAcademicYearId:Number(y),asInsertedById:h};l(O(d))}},S=()=>{let t=!1;return(x==="2"||x==="3")&&(t=!0),t},B=()=>{let t=!1;return r.length>0&&r[0].LeaveId!=null&&r[0].LeaveId!=0&&(t=!0),t},me=()=>r.length>0&&r[0].IsFinalApprover==="True"?"Final Approve":"Approve",je=e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Here you can apply for, approve, or reject leave requests.",children:e.jsx(I,{sx:{bgcolor:C[500],color:"white","&:hover":{bgcolor:C[600]}},children:e.jsx(Te,{})})}),e.jsx(L,{children:S()&&B&&e.jsx(e.Fragment,{children:e.jsx(E,{title:"Reject",children:e.jsx("span",{children:e.jsx(I,{disabled:r.length>0&&r[0].Text6!="",sx:{backgroundColor:F[500],color:"white","&:hover":{backgroundColor:F[600]}},onClick:ve,children:e.jsx(Ue,{})})})})})}),S()&&B&&e.jsx(e.Fragment,{children:e.jsx(E,{title:me(),children:e.jsx("span",{children:e.jsx(I,{disabled:r.length>0&&r[0].Text6!="",sx:{backgroundColor:V[500],color:"white","&:hover":{backgroundColor:V[600]}},onClick:he,children:e.jsx(Ve,{})})})})})]});return e.jsxs(L,{sx:{px:2},children:[e.jsx(Re,{navLinks:[{title:"Leave Details",path:"/RITeSchool/Teacher/LeaveDetails"},o?{title:"Apply / Approve / Reject Leave page",path:"/RITeSchool/Teacher/ViewLeaveDetails/"}:{title:"Apply / Approve / Reject Leave page",path:"/RITeSchool/Teacher/ViewLeaveDetails"}],rightActions:je}),e.jsx(ke,{sx:{mb:"10px"},children:e.jsxs(we,{defaultExpanded:!0,children:[e.jsx(Ae,{expandIcon:e.jsx(Ne,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsx(Be,{style:{fontWeight:"bold",fontSize:"20px"},children:"Important Notes"})}),e.jsxs(Ce,{sx:{gap:.1,display:"flex",flexDirection:"column"},children:[e.jsxs(U,{variant:"filled",severity:"info",sx:{mb:1,mt:"0.1px"},children:[e.jsx("b",{children:"Note 1 :"})," ",e.jsx(e.Fragment,{children:"Leave balance "}),ie]}),e.jsxs(U,{variant:"filled",severity:"info",children:[e.jsx("b",{children:"Note 2 : "})," ",ce]})]})]})}),e.jsx(L,{sx:{p:2,background:"white"},children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(z,{fullWidth:!0,InputLabelProps:{shrink:!0},label:e.jsx(e.Fragment,{children:"Staff Name"}),sx:{bgcolor:"#F0F0F0"},InputProps:{readOnly:!0},value:m})}),e.jsxs(n,{item:!0,xs:12,md:4,children:[e.jsx($,{DateValue:j,onDateChange:ue,label:"Start Date",size:"medium",disabled:!0}),e.jsx(s,{Error:te}),e.jsx(s,{Error:se}),e.jsx(s,{Error:X})]}),e.jsxs(n,{item:!0,xs:12,md:4,children:[e.jsx($,{DateValue:D,onDateChange:pe,label:"End Date",size:"medium",disabled:!0}),e.jsx(s,{Error:oe}),e.jsx(s,{Error:ae}),e.jsx(s,{Error:re}),e.jsx(s,{Error:ee})]}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(z,{label:e.jsxs(e.Fragment,{children:["Total Days ",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:q,InputProps:{readOnly:!0},onChange:t=>R(t.target.value),fullWidth:!0,disabled:!0})}),e.jsxs(n,{item:!0,xs:12,md:4,children:[e.jsx(Fe,{sx:{minWidth:"20vw"},ItemList:le,onChange:xe,label:"Leave Type",defaultValue:J,mandatory:!0,disabled:!0}),e.jsx(s,{Error:Q})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(P,{label:e.jsxs(e.Fragment,{children:["Description ",e.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:3,value:Z,onChange:t=>w(t.target.value),fullWidth:!0,InputProps:{readOnly:!0}}),e.jsx(s,{Error:ne})]}),S()&&e.jsxs(n,{item:!0,xs:12,children:[e.jsx(P,{label:e.jsxs(e.Fragment,{children:["Remark ",e.jsx("span",{style:{color:"red"},children:"*"})]}),InputProps:{readOnly:r.length>0&&r[0].Text6!==""},multiline:!0,rows:3,value:p,onChange:t=>{A(t.target.value)},fullWidth:!0}),e.jsx(s,{Error:K})]})]})})]})};export{Qe as default};
