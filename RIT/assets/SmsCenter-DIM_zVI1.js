import{cc as As,j as e,U as qe,V as Je,af as Qe,B as n,ag as ke,ah as De,ai as $,aj as S,bH as Z,ak as Me,E as g,I as j,ao as Pt,G as w,r,S as _t,u as Lt,c as I,e5 as Ot,e6 as Bt,T as C,b9 as Ns,ay as Ke,e7 as Ts,av as ye,s as Es,A as Ps,e8 as _s,z as Ls,e9 as Os,t as Rt,ea as Ie,eb as Bs,ec as Us,ed as At,bl as _,ee as He,C as zs,n as be,o as de,dk as Ve,F as z,H as ve,ap as H,aq as $e,J as V,l as Fe,y as Hs,ef as Vs,eg as $s,eh as Fs}from"./index-CpZD2H93.js";import{d as Nt}from"./AddCircle-BWwMsra3.js";import{d as Tt}from"./Download-DbybsM_Q.js";import{d as Ws}from"./PriorityHigh-GKb8m_z9.js";import{d as X}from"./ArrowCircleUp-C3u-oYJu.js";import{A as Xe}from"./ArrowCircleDown-7BHmj5tB.js";import{L as Re}from"./Link-QB4wltBd.js";import{L as Ys}from"./CardStyle-CBuNm0_N.js";import{T as Ks}from"./CommonStyle-DTS3LGaG.js";import{L as Gs}from"./Legend-BBFIM_kK.js";import{d as We}from"./ArrowCircleDown-CuaRBylZ.js";import{C as xe}from"./Card-B0aZ7mGs.js";import{y as Et}from"./yellow-BQYah5ZS.js";const Ye=As(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddTwoTone");var Ze={},qs=Je;Object.defineProperty(Ze,"__esModule",{value:!0});var Ut=Ze.default=void 0,Js=qs(qe()),Qs=e,Xs=(0,Js.default)((0,Qs.jsx)("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"AccessAlarm");Ut=Ze.default=Xs;var et={},Zs=Je;Object.defineProperty(et,"__esModule",{value:!0});var zt=et.default=void 0,er=Zs(qe()),tr=e,sr=(0,er.default)((0,tr.jsx)("path",{d:"M20 6H10v6H8V4h6V0H6v6H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"}),"MarkunreadMailbox");zt=et.default=sr;var tt={},rr=Je;Object.defineProperty(tt,"__esModule",{value:!0});var Ge=tt.default=void 0,nr=rr(qe()),or=e,ar=(0,nr.default)((0,or.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z"}),"SmsFailed");Ge=tt.default=ar;function lr({isPrincipal:i,ItemList:b,HeaderArray:f,ClickHeader:h,clickEdit:k,clickchange:u,clickTitle:D}){const y=s=>{const o=f.map(l=>l.Id===s?{...l,SortOrder:l.SortOrder==="DESC"?"ASC":"DESC"}:{...l,SortOrder:null});h(o)},M=()=>{let s=!0;return b.map(o=>{o.IsActive||(s=!1)}),s},x=()=>{const s=!M();let o=b.map(l=>({...l,IsActive:s}));u(o)},m=s=>{let o=b.map(l=>l.Id==s?{...l,IsActive:!l.IsActive}:l);u(o)};return e.jsx(e.Fragment,{children:e.jsx(Qe,{component:n,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:[e.jsx(De,{children:e.jsxs($,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{sx:{p:1.5},checked:M(),onChange:x})}),f.map((s,o)=>e.jsx(S,{sx:{textTransform:"capitalize",color:l=>l.palette.common.white,py:1.5},onClick:o<3?()=>y(s.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:o<3?"flex-start":"center"},children:[e.jsx("b",{children:s.Header}),s.SortOrder!==null&&o<3?s.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(X,{}):null]})},o))]})}),e.jsx(Me,{children:b.map((s,o)=>e.jsxs($,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{checked:s.IsActive,onChange:()=>m(s.Id)})}),i&&e.jsx(g,{title:s.SenderName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5,width:"200px",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.SenderName})}),e.jsx(g,{title:s.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>D(s.Id),children:s.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.Insert_Date}),e.jsx(S,{sx:{textAlign:"center",py:.5},align:"center",children:e.jsx(g,{title:"Edit",children:e.jsx(j,{onClick:()=>k(s.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Pt,{})})})})]},o))})]})})})}function cr({isPrincipal:i,ItemList:b,HeaderArray:f,ClickHeader:h,clickEdit:k,clickchange:u,clickTitle:D}){const y=s=>{const o=f.map(l=>l.Id===s?{...l,SortOrder:l.SortOrder==="DESC"?"ASC":"DESC"}:{...l,SortOrder:null});h(o)},M=()=>{let s=!0;return b.map(o=>{o.IsActive||(s=!1)}),s},x=()=>{const s=!M();let o=b.map(l=>({...l,IsActive:s}));u(o)},m=s=>{let o=b.map(l=>l.Id==s?{...l,IsActive:!l.IsActive}:l);u(o)};return e.jsx(e.Fragment,{children:e.jsx(Qe,{component:n,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`,overflowY:"hidden"},children:[e.jsx(De,{children:e.jsxs($,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{sx:{p:1.5},checked:M(),onChange:x})}),f.map((s,o)=>e.jsx(S,{sx:{textTransform:"capitalize",color:l=>l.palette.common.white,py:1.5},onClick:o>=1&&o<3?()=>y(s.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:(o<3,"flex-start")},children:[e.jsx("b",{children:s.Header}),s.SortOrder!==null&&o>=1&&o<3?s.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(X,{}):null]})},o))]})}),e.jsx(Me,{children:b.map((s,o)=>e.jsxs($,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{checked:s.IsActive,onChange:()=>m(s.Id)})}),i&&e.jsx(g,{title:s.SenderName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5,width:"200px",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.SenderName})}),e.jsx(g,{title:s.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>D(s.Id),children:s.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.Insert_Date}),e.jsx(S,{sx:{textAlign:"center",py:.5},align:"center",children:e.jsx(g,{title:"Edit",children:e.jsx(j,{onClick:()=>k(s.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Pt,{})})})})]},o))})]})})})}const ir=({ItemList:i,DefaultValue:b,clickItem:f})=>(console.log(i,"ItemList"),e.jsx(w,{container:!0,item:!0,spacing:{xs:1,sm:0},direction:{xs:"row",sm:"column"},children:i.map(h=>e.jsx(w,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A"},children:e.jsxs(Ys,{sx:Ks,color:h.Value==b?"secondary":"primary",onClick:()=>{f(h.Value)},children:[i.Badge,h.Icon,e.jsx("br",{}),h.Name]})}))}));function dr({ItemList:i,HeaderArray:b,ClickHeader:f,clickchange:h,clickTitle:k}){const u=x=>{const m=b.map(s=>s.Id===x?{...s,SortOrder:s.SortOrder==="DESC"?"ASC":"DESC"}:{...s,SortOrder:null});f(m)},D=()=>{let x=!0;return i.map(m=>{m.IsActive||(x=!1)}),x},y=()=>{const x=!D();let m=i.map(s=>({...s,IsActive:x}));h(m)},M=x=>{let m=i.map(s=>s.Id==x?{...s,IsActive:!s.IsActive}:s);h(m)};return e.jsx(e.Fragment,{children:e.jsx(Qe,{component:n,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:x=>`1px solid ${x.palette.grey[300]}`,overflowY:"hidden"},children:[e.jsx(De,{children:e.jsxs($,{sx:{background:x=>x.palette.secondary.main,color:x=>x.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{sx:{p:1.5},checked:D(),onChange:y})}),b.map((x,m)=>e.jsx(S,{sx:{textTransform:"capitalize",color:s=>s.palette.common.white,py:1.5},onClick:m>=0&&m<3?()=>u(x.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:(m<3,"flex-start")},children:[e.jsx("b",{children:x.Header}),x.SortOrder!==null&&m>=0&&m<3?x.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(X,{}):null]})},m))]})}),e.jsx(Me,{children:i.map((x,m)=>e.jsxs($,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(Z,{checked:x.IsActive,onChange:()=>M(x.Id)})}),e.jsx(g,{title:x.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:x.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>k(x.Id),children:x.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:x.Insert_Date})]},m))})]})})})}function xr(){const[i,b]=r.useState({startDate:null,endDate:null});_t(),r.useState(!1);const f=Lt();I(d=>d.SmsCenter.SmsList);const h=I(d=>d.SmsCenter.NewSmsList),k=I(d=>d.SmsCenter.Loading);I(d=>d.SmsCenter.MobileNumber);const[u,D]=r.useState(1),[y,M]=r.useState(20),x=[20,50,100,200],m=sessionStorage.getItem("AcademicYearId"),s=localStorage.getItem("localSchoolId"),o=sessionStorage.getItem("Id"),l=sessionStorage.getItem("RoleId"),[L,F]=r.useState("desc"),[R,st]=r.useState("Date"),O=h.filter(d=>d.TotalRows!==void 0).map(d=>d.TotalRows),W=[...new Set(O)][0];r.useEffect(()=>{const d={asSchoolId:s,asAcademicYearId:m,asUserId:o,asUserRoleId:l};localStorage.setItem("url",window.location.pathname),f(Ot(d))},[]);const nt=h.filter(d=>{if(!i.startDate&&!i.endDate)return!0;const A=new Date(d.Date);return i.startDate&&!i.endDate?A>=i.startDate:(!i.startDate&&i.endDate||A>=i.startDate)&&A<=i.endDate}).sort((d,A)=>{let Y=0;return R==="Date"?Y=new Date(d.Date).getTime()-new Date(A.Date).getTime():R==="UserName"?Y=d.UserName.localeCompare(A.UserName):R==="Subject"&&(Y=d.Subject.localeCompare(A.Subject)),L==="asc"?Y:-Y}),B=d=>{R===d?F(L==="asc"?"desc":"asc"):(st(d),F("asc"))},he={asSchoolId:s,asAcademicYearId:m,asUserId:o,asReceiverUserRoleId:l,asStartIndex:(u-1)*y,asPageSize:y},ee=(u-1)*y+1,v=Math.min(u*y,W),Se=Math.ceil(W/y),te=d=>{M(parseInt(d.target.value,10)),D(1)},ot=d=>{D(d)};r.useEffect(()=>{f(Bt(he))},[u,y,R,L,i,ee,v]);const G=nt;let ue="/RITeSchool/Student/viewsms/";return e.jsx(n,{children:e.jsx(w,{container:!0,children:e.jsxs(w,{item:!0,sx:{minWidth:"100%",background:"white"},children:[W>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(C,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[ee," to ",v]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:W})," ",W===1?"record":"records"]})}):e.jsx("span",{children:" "}),e.jsx(n,{children:k?e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Ns,{})}):G.length>0?e.jsxs(ke,{"aria-label":"simple table",sx:{border:d=>`1px solid ${d.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(De,{children:e.jsxs($,{sx:{background:d=>d.palette.secondary.main,color:d=>d.palette.common.white},children:[e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>B("UserName"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["From ",R==="UserName"&&(L==="asc"?e.jsx(X,{}):e.jsx(We,{}))]})}),e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>B("Subject"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["SMS Text ",R==="Subject"&&(L==="asc"?e.jsx(X,{}):e.jsx(We,{}))]})}),e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>B("Date"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Received Date ",R==="Date"&&(L==="asc"?e.jsx(X,{}):e.jsx(We,{}))]})})]})}),e.jsx(Me,{children:G.map((d,A)=>e.jsxs($,{children:[e.jsx(S,{sx:{py:1},children:d.UserName}),e.jsx(S,{sx:{py:1},children:e.jsx(Re,{href:ue+Ke(d.SMS_Id),children:d.Subject})}),e.jsx(S,{sx:{py:1},children:Ts(new Date(d.Date))})]},A))})]}):e.jsx(C,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No record found."})})}),e.jsx(n,{mt:1,children:v>19?e.jsx(ye,{rowsPerPage:y,ChangeRowsPerPage:te,rowsPerPageOptions:x,PageChange:ot,pagecount:Se}):e.jsx("span",{})})]})})})}const hr=Es(xe)(({theme:i})=>({backgroundColor:i.palette.mode==="dark"?"#1A2027":"#fff",...i.typography.body2,padding:i.spacing(1),textAlign:"center",height:"61px",color:"black",boxShadow:"0px 8px 15px rgba(0, 0, 0, 0.1)"}));function kr(){const[i,b]=r.useState({startDate:null,endDate:null}),f=_t();r.useState(!1);const h=Lt(),k=Ps();I(t=>t.SmsCenter.SmsList);const u=I(t=>t.SmsCenter.NewSmsList),D=I(t=>t.SmsCenter.SmsCountDetails);I(t=>t.SmsCenter.Loading);const y=I(t=>t.SmsCenter.MobileNumber),[M,x]=r.useState(1),[m,s]=r.useState(20),o=sessionStorage.getItem("AcademicYearId"),l=localStorage.getItem("localSchoolId"),L=sessionStorage.getItem("DesignationName"),F=sessionStorage.getItem("Id"),R=sessionStorage.getItem("RoleId"),[st,K]=r.useState([]),[O,rt]=r.useState("");r.useState("Insert_Date");const[W,nt]=r.useState("desc");let B=[],he=[],ee=[];r.useEffect(()=>{B=u==null?void 0:u.filter(t=>t.TotalRows!==void 0),he=B==null?void 0:B.map(t=>t.TotalRows),ee=[...new Set(he)],ee[0]},[u]);const[v,Se]=r.useState(""),[te,ot]=r.useState("Date"),G=window.location.pathname,ue=G.indexOf("/RITeSchool/Teacher/SmsCenter/")===-1?G.replace("/RITeSchool/Teacher/SmsCenter",""):G.replace("/RITeSchool/Teacher/SmsCenter/","");r.useEffect(()=>{const t={asSchoolId:l,asAcademicYearId:o,asUserId:F,asUserRoleId:R},a={asUserId:F,asAcademicYearId:o,asSchoolId:l};localStorage.setItem("url",window.location.pathname),h(Ot(t)),h(_s(a)),Se(ue===""?"Received SMS":ue)},[]),r.useEffect(()=>{let t=[];u.length>0&&(t=u.filter(a=>{if(!i.startDate&&!i.endDate)return!0;const c=new Date(a.Date);return i.startDate&&!i.endDate?c>=i.startDate:(!i.startDate&&i.endDate||c>=i.startDate)&&c<=i.endDate}).filter(a=>a.UserName.toLowerCase().includes(O.toLowerCase())||a.Subject.toLowerCase().includes(O.toLowerCase())).sort((a,c)=>{let p=0;return te==="Date"?p=new Date(a.Date).getTime()-new Date(c.Date).getTime():te==="UserName"?p=a.UserName.localeCompare(c.UserName):te==="Subject"&&(p=a.Subject.localeCompare(c.Subject)),W==="asc"?p:-p})),K(t)},[u]);const d={asSchoolId:l,asAcademicYearId:o,asUserId:F,asReceiverUserRoleId:R,asStartIndex:(M-1)*m,asPageSize:M*m};r.useEffect(()=>{h(Bt(d))},[M,m]),r.useEffect(()=>{u&&K(u)},[u]);const A=t=>{t==="Compose SMS"&&k("/RiteSchool/Teacher/ComposeSMS",{state:{fromInternal:!0}}),Se(t)},Y=()=>{localStorage.setItem("ViewSMSData","")},Ht=t=>{rt(t)},at=()=>{if(O==="")K(u);else{const t=u.filter(a=>{const c=a.UserName.toLowerCase().includes(O.toLowerCase()),p=a.Subject.toLowerCase().includes(O.toLowerCase());return c||p});K(t)}};r.useEffect(()=>{K(u)},[u]);const Ae=Number(localStorage.getItem("UserId")),[T,Vt]=r.useState(""),[se,$t]=r.useState(""),[N,q]=r.useState([]),[Ne,Ft]=r.useState("");r.useState("");const[P,Wt]=r.useState(20),lt=[20,50,100,200],[Te,Ee]=r.useState(1),me=(Te-1)*P,ct=me+P,{showAlert:re,closeAlert:E}=r.useContext(Ls),[ne,Yt]=r.useState("ORDER BY Insert_Date DESC "),[Pe,Kt]=r.useState("ORDER BY Insert_Date DESC "),oe=L=="Principal"&&v=="AllSendItem",[Gt,qt]=r.useState([{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Sent Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"},{Id:4,Header:"Resend",SortOrder:null,sortKey:"CreaterName"}]),[Jt,Qt]=r.useState([{Id:0,Header:"From",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Sent Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"},{Id:4,Header:"Resend",SortOrder:null,sortKey:"CreaterName"}]),Xt=t=>{qt(t);const a=t.find(p=>p.SortOrder!==null),c=a?`${a.sortKey} ${a.SortOrder}`:"Created_Date desc";Yt(c)},Zt=t=>{Qt(t);const a=t.find(p=>p.SortOrder!==null),c=a?`${a.sortKey} ${a.SortOrder}`:"Created_Date desc";Kt(c)},U=I(t=>t.SentSms.ISGetSentItems),ae=I(t=>t.SentSms.Loading),J=U.length>0?U[0].TotalRows:null,_e=I(t=>t.SentSms.ISDeleteSMS),it=I(t=>t.SentSms.ISExportSentItems),pe=I(t=>t.SentSms.ISResendSMS),dt=t=>{Vt(t)},xt=t=>{$t(t)},es=()=>{q(se===""?U:U.filter(t=>{const a=t.SenderName.toLowerCase().includes(T.toLowerCase()),c=t.StatusId.toLowerCase().includes(T.toLowerCase()),p=t.Subject.toLowerCase().includes(T.toLowerCase()),we=t.Insert_Date.toLowerCase().includes(T.toLowerCase());return a||c||p||we})),h(Ie(je))},Q=()=>{es(),q(T===""?U:U.filter(t=>{const a=t.SenderName.toLowerCase().includes(T.toLowerCase()),c=t.StatusId.toLowerCase().includes(T.toLowerCase());return a||c})),h(Ie(je))},ht=(Te-1)*P+1,ge=Math.min(Te*P,J),St=Math.ceil(J/P),ut=t=>{Wt(parseInt(t.target.value,10)),Ee(1)},mt=t=>{Ee(t)},je={asSchoolId:Number(l),asUser_Id:Ae,asReceiver_User_Role_Id:2,asAcademic_Year_Id:Number(o),asSortExp:oe?Pe:ne,asprm_StartIndex:me,asPageSize:ct,asName:T,asContent:se,asViewAllSMS:v=="AllSendItem"?1:0},ts={asSchoolId:Number(l),asUser_Id:Ae,asReceiver_User_Role_Id:2,asAcademic_Year_Id:Number(o),asSortExp:oe?Pe:ne,asprm_StartIndex:me,asPageSize:1e3,asName:T,asContent:se,asViewAllSMS:v=="AllSendItem"?1:0},pt=()=>{if(!Ne||Ne.length===0){re({title:"Error",message:"At least one SMS should be selected for deletion.",variant:"error",confirmButtonText:"OK",cancelButtonText:"Cancel",onConfirm:()=>{E()},onCancel:()=>{E()}});return}const t={asSMS_Id:Ne.toString(),asSchoolId:Number(l)};re({title:"Please Confirm",message:"Are you sure you want to delete the selected SMS(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{E()},onConfirm:()=>{h(Vs(t)),E()}})};r.useEffect(()=>{_e!=""&&(h(Os()),Rt.success(_e),h(Ie(je)))},[_e]);const[gt,ss]=r.useState(""),[jt,rs]=r.useState(""),[ns,os]=r.useState(""),[as,ls]=r.useState("");r.useEffect(()=>{if(pe&&pe.length>0){const t=pe[0];ss(t.SMS_Text),rs(t.Display_Text),os(t.RoleId),ls(t.UserId)}},[pe]);const ft=t=>{const a={asSmsId:Number(t),asSchoolId:Number(l),asAcademicYearId:Number(o)};h($s(a)),gt&&jt&&ns&&as&&k("/RITeSchool/Teacher/ComposeSMS",{state:{SMS_Text:gt,Display_Text:jt,RoleId:R,UserId:F,fromInternal:!0}})},Le=t=>{k("/RITeSchool/Teacher/ComposeSMS",{state:{fromInternal:!0}})},Ct=t=>{q(t);const a=t.filter(c=>c.IsActive).map(c=>c.Id);Ft(a)},wt=t=>{k("/RITeSchool/Teacher/ViewSmsNew/"+Ke(t),{state:{fromInternal:!0}})},cs=()=>{let t="";if(it.length>0){const a=["RowID","From","To","SMSText","SendDate"],c=it.map(p=>[p.RowID,p.From,p.To,p.SMSText,p.SendDate]);t=[a.join(","),...c.map(p=>p.map(we=>`"${String(we||"").replace(/"/g,'""')}"`).join(","))].join(`
`)}return t},is=()=>{try{const t=cs(),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),p=URL.createObjectURL(a);c.setAttribute("href",p),c.setAttribute("download","SentSmsDetails.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(t){console.error("Error exporting to CSV:",t)}},It=()=>{re({title:"Please Confirm",message:"This Action will show only saved details. Do you want to continue?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{E()},onConfirm:()=>{is(),E()}})};r.useEffect(()=>{h(Bs(ts))},[me,ct,ne,Pe,oe]),r.useEffect(()=>{h(Ie(je))},[P,ne,v,ne]),r.useEffect(()=>{q(U)},[U]);const le=I(t=>t.SmsCenter.GetScheduleSMSBodyIS),fe=I(t=>t.SmsCenter.DeleteScheduleSMSIS),ds=I(t=>t.SmsCenter.Loading),Ce=le.length>0?le[0].TotalRows:null,[bt,xs]=r.useState("ORDER BY Insert_Date DESC "),[Oe,hs]=r.useState(""),[ce,Ss]=r.useState(20),us=[20,50,100,200],[Be,ms]=r.useState(1),Ue=(Be-1)*ce,vt=Ue+ce,ps=(Be-1)*ce+1,yt=Math.min(Be*ce,Ce),gs=Math.ceil(Ce/ce),js=t=>{Ss(parseInt(t.target.value,10)),ms(1)},fs=t=>{Ee(t)};console.log(le,"ooo",fe);const[ze,kt]=r.useState([]);r.useEffect(()=>{kt(le)},[le]);const[Cs,ws]=r.useState([{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Scheduled Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"}]),Is=t=>{ws(t);const a=t.find(p=>p.SortOrder!==null),c=a?`${a.sortKey} ${a.SortOrder}`:"Created_Date desc";xs(c)},Dt={asSchoolId:Number(l),asUserId:Ae,asReceiverUserRoleId:2,asAcademicYearId:Number(o),asSortExp:bt,asStartIndex:Ue,asPageSize:vt},bs={asSMSIds:Oe.toString(),asSchoolId:Number(l),asAcademicYearId:Number(o)},vs=t=>{kt(t);const a=t.filter(c=>c.IsActive).map(c=>c.Id);hs(a)},ys=()=>{if(!Oe||Oe.length===0){re({title:"Error",message:"At least one SMS should be selected for deletion.",variant:"error",confirmButtonText:"OK",cancelButtonText:"Cancel",onConfirm:()=>{E()},onCancel:()=>{E()}});return}re({title:"Please Confirm",message:"Are you sure you want to delete the selected SMS(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{E()},onConfirm:()=>{h(Fs(bs)),E()}})};r.useEffect(()=>{fe!=""&&(h(Us()),Rt.success(fe),h(At(Dt)))},[fe]);const ks=t=>{k("/RITeSchool/Teacher/ViewSmsNew/"+Ke(t),{state:{fromInternal:!0}})};r.useEffect(()=>{h(At(Dt))},[bt,Ue,vt]);const[Ds,Ms]=r.useState(2),ie=t=>{const a=Mt.find(c=>c.Value===t);A(a.Name),Ms(t)},Rs=[{id:1,Name:"Processed SMS",Value:e.jsx(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(n,{sx:{width:23,height:23,backgroundColor:_[100],border:"1px solid black"}})})}],Mt=[{Id:1,Name:"Compose SMS",Value:1,Icon:e.jsx(Nt,{onClick:ie,sx:{mt:.5,color:"#38548A"},className:f.IconSize}),Badge:""},{Id:2,Name:"Received SMS",Value:2,Icon:e.jsx(zt,{onClick:ie,sx:{mt:.5,color:"#38548A"},className:f.IconSize}),Badge:""},{Id:3,Name:"Send Item",Value:3,Icon:e.jsx(He,{onClick:ie,sx:{mt:.5,color:"#38548A"},className:f.IconSize}),Badge:""},{Id:4,Name:"Scheduled SMS",Value:4,Icon:e.jsx(Ut,{onClick:ie,sx:{mt:.5,color:"#38548A"},className:f.IconSize}),Badge:""}];return e.jsxs(n,{sx:{px:2},children:[e.jsx(zs,{navLinks:[{title:"SMS Center",path:"/RITeSchool/Student/SmsCenter"}],rightActions:e.jsxs(e.Fragment,{children:[v=="Received SMS"&&e.jsx(e.Fragment,{children:e.jsxs(be,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(de,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"To / From / SMS Text",value:O,variant:"outlined",size:"small",onChange:t=>{Ht(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&at()}})}),e.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsxs(be,{direction:"row",gap:1,alignItems:"right",sx:{flexWrap:{xs:"wrap",sm:"nowrap"},justifyContent:{xs:"flex-start",sm:"flex-start"}},children:[e.jsx(j,{onClick:at,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx(Ve,{})}),e.jsx(n,{children:e.jsx(g,{title:"School SMS will be sent to below listed number(s). To add/update the number, please send the information to admin staff via message center.",children:e.jsx(j,{sx:{color:"white",backgroundColor:Et[700],height:"36px !important",":hover":{backgroundColor:Et[800]}},children:e.jsx(Ws,{})})})}),e.jsx(n,{children:e.jsx(g,{title:"Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(j,{sx:{color:"white",backgroundColor:z[500],height:"36px !important",":hover":{backgroundColor:z[600]}},children:e.jsx(ve,{})})})})]})})]})}),v=="Send Item"&&e.jsx(e.Fragment,{children:e.jsxs(be,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(de,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Name / Reg. No. / User Name :",value:T,variant:"outlined",size:"small",inputProps:{maxLength:50},onChange:t=>{dt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&Q()}})}),e.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(de,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Content :",value:se,variant:"outlined",size:"small",inputProps:{maxLength:100},onChange:t=>{xt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&Q()}})}),e.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsxs(be,{direction:"row",gap:1,alignItems:"right",sx:{flexWrap:{xs:"wrap",sm:"nowrap"},justifyContent:{xs:"flex-start",sm:"flex-start"}},children:[e.jsx(j,{onClick:Q,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx(Ve,{})}),N.length>0&&e.jsx(n,{children:e.jsx(g,{title:"Delete",children:e.jsx(j,{onClick:pt,sx:{color:"white",backgroundColor:H[500],"&:hover":{backgroundColor:H[600]}},children:e.jsx($e,{})})})}),e.jsx(n,{children:e.jsx(g,{title:"Export",children:e.jsx(j,{sx:{color:"white",backgroundColor:_[500],"&:hover":{backgroundColor:_[600]}},onClick:It,children:e.jsx(Tt,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(j,{onClick:Le,sx:{color:"white",backgroundColor:V[500],height:"36px !important",":hover":{backgroundColor:V[600]}},children:e.jsx(Ye,{})})}),e.jsx(n,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(j,{sx:{color:"white",backgroundColor:z[500],"&:hover":{backgroundColor:z[600]}},children:e.jsx(ve,{})})})})]})})]})}),v=="AllSendItem"&&e.jsxs(e.Fragment,{children:[e.jsx(de,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Name / Reg. No. / User Name :",value:T,variant:"outlined",size:"small",inputProps:{maxLength:50},onChange:t=>{dt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&Q()}}),e.jsx(de,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Content :",value:se,variant:"outlined",size:"small",inputProps:{maxLength:100},onChange:t=>{xt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&Q()}}),e.jsx(j,{onClick:Q,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx(Ve,{})}),N.length>0&&e.jsx(n,{children:e.jsx(g,{title:"Delete",children:e.jsx(j,{onClick:pt,sx:{color:"white",backgroundColor:H[500],"&:hover":{backgroundColor:H[600]}},children:e.jsx($e,{})})})}),e.jsx(n,{children:e.jsx(g,{title:"Export",children:e.jsx(j,{sx:{color:"white",backgroundColor:_[500],"&:hover":{backgroundColor:_[600]}},onClick:It,children:e.jsx(Tt,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(j,{onClick:Le,sx:{color:"white",backgroundColor:V[500],height:"36px !important",":hover":{backgroundColor:V[600]}},children:e.jsx(Ye,{})})}),e.jsx(n,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(j,{sx:{color:"white",backgroundColor:z[500],"&:hover":{backgroundColor:z[600]}},children:e.jsx(ve,{})})})})]}),v=="Scheduled SMS"&&e.jsxs(e.Fragment,{children:[N.length>0&&e.jsx(n,{children:e.jsx(g,{title:"Delete",children:e.jsx(j,{onClick:ys,sx:{color:"white",backgroundColor:H[500],"&:hover":{backgroundColor:H[600]}},children:e.jsx($e,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(j,{onClick:Le,sx:{color:"white",backgroundColor:V[500],height:"36px !important",":hover":{backgroundColor:V[600]}},children:e.jsx(Ye,{})})}),e.jsx(n,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(j,{sx:{color:"white",backgroundColor:z[500],"&:hover":{backgroundColor:z[600]}},children:e.jsx(ve,{})})})})]})]})}),e.jsxs(n,{children:[e.jsxs(w,{container:!0,item:!0,spacing:1,children:[e.jsx(w,{item:!0,xs:12,sm:3,md:2,lg:1.5,children:e.jsx(ir,{ItemList:Mt,DefaultValue:Ds,clickItem:ie})}),e.jsxs(w,{item:!0,xs:12,sm:9,md:10,lg:10.5,children:[v=="AllSendItem"&&e.jsxs(n,{mb:1,sx:{background:"white",p:2},children:[ae&&e.jsx(Fe,{}),N.length>0&&e.jsxs(n,{mb:0,sx:{background:"white"},children:[N.length>0?e.jsx(n,{style:{flex:1,textAlign:"center"},children:e.jsxs(C,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[ht," to ",ge]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:J})," ",J===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(n,{children:e.jsx(cr,{HeaderArray:Jt,ItemList:N,ClickHeader:Zt,clickEdit:ft,clickchange:Ct,clickTitle:wt,isPrincipal:oe})}),ge>19?e.jsx(ye,{rowsPerPage:P,ChangeRowsPerPage:ut,rowsPerPageOptions:lt,PageChange:mt,pagecount:St}):e.jsx("span",{})]}),N.length==0&&!ae?e.jsx(C,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]}),v=="Received SMS"&&e.jsxs(n,{mb:1,sx:{background:"white",p:2},children:[e.jsxs(w,{container:!0,item:!0,spacing:2,children:[e.jsx(w,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(xe,{sx:{backgroundColor:_[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(He,{sx:{color:_[600],fontSize:36,mr:2}}),e.jsxs(n,{children:[e.jsx(C,{variant:"h6",color:"blue",children:"Free SMS"}),e.jsx(C,{variant:"h4",children:D.AllowedSMSCount??0})]})]})}),e.jsx(w,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(xe,{sx:{backgroundColor:V[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(He,{sx:{color:V[600],fontSize:36,mr:2}}),e.jsxs(n,{children:[e.jsx(C,{variant:"h6",color:"green",children:"Sent SMS"}),e.jsx(C,{variant:"h4",children:D.SentSMSCount??0})]})]})}),e.jsx(w,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(xe,{sx:{backgroundColor:_[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(Ge,{sx:{color:_[600],fontSize:36,mr:2}}),e.jsxs(n,{children:[e.jsx(C,{variant:"h6",color:"blue",children:"Balance SMS"}),e.jsx(C,{variant:"h4",children:"0"})]})]})}),e.jsx(w,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(xe,{sx:{backgroundColor:H[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(Ge,{sx:{color:H[600],fontSize:36,mr:1}}),e.jsxs(n,{children:[e.jsx(C,{variant:"h6",color:"red",children:"Exceeded SMS"}),e.jsx(C,{variant:"h4",children:D.ExceededSMSCount??0})]})]})})]}),e.jsx(n,{mb:1,sx:{p:1,textAlign:"center"},children:e.jsx(C,{variant:"h6",children:e.jsxs("strong",{children:[" Mobile Number : ",y]})})}),e.jsx(xr,{})]}),v=="Send Item"&&e.jsxs(n,{mb:1,sx:{background:"white",p:2},children:[ae&&e.jsx(Fe,{}),N.length>0&&e.jsxs(n,{mb:1,sx:{background:"white"},children:[N.length>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(C,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[ht," to ",ge]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:J})," ",J===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(lr,{HeaderArray:Gt,ItemList:N,ClickHeader:Xt,clickEdit:ft,clickchange:Ct,clickTitle:wt,isPrincipal:oe}),ge>19?e.jsx(ye,{rowsPerPage:P,ChangeRowsPerPage:ut,rowsPerPageOptions:lt,PageChange:mt,pagecount:St}):e.jsx("span",{})]}),N.length==0&&!ae?e.jsx(C,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]}),v==="Scheduled SMS"&&e.jsxs(n,{mb:1,sx:{background:"white",p:2},children:[e.jsx(n,{sx:{background:"white",p:1,mb:1},children:e.jsx(Gs,{LegendArray:Rs})}),ds&&e.jsx(Fe,{}),ze.length>0&&e.jsxs(n,{mb:1,sx:{background:"white"},children:[ze.length>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(C,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[ps," to ",yt]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:Ce})," ",Ce===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(dr,{HeaderArray:Cs,ItemList:ze,ClickHeader:Is,clickchange:vs,clickTitle:ks}),yt>19?e.jsx(ye,{rowsPerPage:P,ChangeRowsPerPage:js,rowsPerPageOptions:us,PageChange:fs,pagecount:gs}):e.jsx("span",{})]}),N.length==0&&!ae?e.jsx(C,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]})]})]}),e.jsx("span",{style:{width:"95px",position:"fixed",bottom:"70px",right:"60px"},children:e.jsx(Hs,{style:{textDecoration:"none"},to:`/${location.pathname.split("/")[1]}/Teacher/ComposeSMS`,children:e.jsxs(hr,{onClick:Y,sx:{fontSize:"10px",mr:1,mb:"60px",borderRadius:"15px",backgroundColor:"#38548A",color:"white"},children:[e.jsx(Nt,{}),e.jsx("br",{}),e.jsx("b",{children:"Compose"})]})})})]})]})}export{kr as default};
