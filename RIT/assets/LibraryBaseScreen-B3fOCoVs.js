import{u as le,c as I,r as a,eQ as Ce,f5 as Ae,j as e,B as l,T as A,G as B,o as U,bI as Z,E as K,I as V,dk as Te,bl as W,af as ie,ag as de,ah as ce,ai as z,aj as n,ak as xe,av as ue,A as De,nr as ee,ns as Pe,nt as _e,nu as Le,nv as ve,nw as Ne,t as Ee,nx as Re,C as we,F as ne,ny as Ge}from"./index-CpZD2H93.js";import{d as Fe}from"./Book-BnwgjmKG.js";import{d as He}from"./RestartAlt-0rWnjZgh.js";import{d as Me}from"./ArrowCircleUp-C3u-oYJu.js";import{A as Oe}from"./ArrowCircleDown-7BHmj5tB.js";import{L as Ue}from"./Link-QB4wltBd.js";import{Q as Ke}from"./QuestionMark-B_7MKkiz.js";const Ve=({BookTitle:i,AccessionNumber:m,Author:k,Publisher:T,StandardId:d,LanguageId:b,IsPrintable:h,setBookTitle:D,setAccessionNumber:f,setAuthor:s,setPublisher:c,setStandardId:x,setLanguageId:S,setIsPrintable:y,clickSearch:j,clickReset:r})=>{const C=le(),w=[{id:"",Name:"All",Value:""},{id:"1",Name:"Printable",Value:"1"},{id:"2",Name:"Non-Printable",Value:"2"}],_=localStorage.getItem("localSchoolId"),G=sessionStorage.getItem("AcademicYearId"),v=I(t=>t.StandardAndExamList.SelectStandard),p=I(t=>t.library.LanguageList);a.useEffect(()=>{C(Ce({asSchoolId:_,asAcademicYearId:G})),C(Ae({aiSchoolId:_}))},[]),a.useEffect(()=>{if(!b&&p.length>0){const t=p.find(se=>se.Value==="");t&&S(t.Value)}},[b,p,S]),a.useEffect(()=>{h==="0"&&y("")},[h,y]);const u=t=>{D(t)},Y=t=>{f(t)},g=t=>{s(t)},F=t=>{c(t)},$=t=>{x(t)},Q=t=>{S(t)},H=t=>{y(t)};return e.jsxs(l,{sx:{p:2,background:"white"},children:[e.jsx(A,{variant:"h4",pb:1,color:"#38548A",children:" Search Criteria  "}),e.jsxs(B,{container:!0,spacing:2,children:[e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Book Title",value:i,onChange:t=>u(t.target.value.slice(0,100)),inputProps:{maxLength:100},size:"medium",onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,size:"medium",label:"Accession Number",value:m,onChange:t=>Y(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Author",size:"medium",value:k,onChange:t=>g(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Publisher",size:"medium",value:T,onChange:t=>F(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(Z,{size:"medium",sx:{width:"100%"},ItemList:p,defaultValue:b,onChange:Q,label:"Language"})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(Z,{size:"medium",sx:{width:"100%"},ItemList:v,defaultValue:d,onChange:$,label:"Standard "})}),e.jsx(B,{item:!0,xs:12,md:3,children:e.jsx(Z,{size:"medium",sx:{width:"100%"},ItemList:w,defaultValue:h,onChange:H,label:"Media Type"})}),e.jsxs(B,{item:!0,xs:12,md:3,children:[e.jsx(K,{title:"Search",children:e.jsx(V,{sx:{background:t=>t.palette.primary.main,color:"white",mt:1,"&:hover":{backgroundColor:t=>t.palette.primary.dark}},onClick:j,children:e.jsx(Te,{})})}),e.jsx(K,{title:"Reset",children:e.jsx(V,{sx:{color:"white",mt:1,ml:1.5,backgroundColor:W[500],"&:hover":{backgroundColor:W[600]}},onClick:r,children:e.jsx(He,{})})})]})]})]})},We={height:"0.5em 1.5em"},ze={padding:"0.2em 1.5em"},Ye=({data:i,clickcliam:m,DefaultValue:k,handleSortChange:T,HeaderArray:d,sortHeader:b,SortExpression:h})=>{const D=s=>{const c=d.find(x=>x.Id===s.Id);if((c==null?void 0:c.sortKey)!==void 0){let x=s.Id==b&&h=="Asc"?"Desc":"Asc";T({Id:s.Id,SortOrder:x})}};I(s=>s.SchoolLibrary.IGetAllBooksDetails);const f=I(s=>s.SchoolLibrary.IGetAllBooksDetailss);return e.jsx(e.Fragment,{children:e.jsx(ie,{children:e.jsxs(de,{"aria-label":"book table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:[e.jsx(ce,{children:e.jsxs(z,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white,...We},children:[d.slice(0,9).map((s,c)=>e.jsx(n,{sx:{textTransform:"capitalize",color:x=>x.palette.common.white,py:1.5},onClick:()=>D(s),children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:[1,2,3,4,5,6].includes(s.Id)?"left":"center"},children:[e.jsx("b",{children:s.Header}),b==s.Id&&(h=="Asc"?e.jsx(Me,{}):e.jsx(Oe,{}))]})},c)),d.slice(9).map((s,c)=>e.jsx(n,{sx:{textTransform:"capitalize",color:x=>x.palette.common.white,py:1.5},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:1,justifyContent:s.Header.includes("Remark Template")?"flex-start ":"center",...ze},children:e.jsx("b",{children:s.Header})})},c+9))]})}),e.jsx(xe,{children:f.map(s=>e.jsxs(z,{children:[e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Book_No}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Book_Title}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Author_Name}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Published_By}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Category_Name}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Language}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",textAlign:"center",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Available_Books}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",textAlign:"center",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Total_Books}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",paddingTop:"2.5px",paddingBottom:"2.5px",textAlign:"center"},children:s.Available_Books==="0"?e.jsx(Ue,{href:"#",onClick:()=>m(s.Book_Id),children:"Claim"}):" "})]},s.Book_Id))})]})})})},$e=({data1:i})=>{const[m,k]=a.useState(5),[T,d]=a.useState(1),b=[20,50,100,200],[h,D]=a.useState(1),f=r=>{k(parseInt(r.target.value,10)),d(1)},s=r=>{d(r)},c=(T-1)*m,x=c+m,S=i.slice(c,x),y=Math.ceil(i.length/m),j=Math.min(h*m);return e.jsxs(l,{children:[e.jsx(ie,{component:l,children:e.jsxs(de,{"aria-label":"book table",sx:{border:r=>`1px solid ${r.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(ce,{children:e.jsxs(z,{sx:{background:r=>r.palette.secondary.main,color:r=>r.palette.common.white},children:[e.jsx(n,{sx:{color:"white",textAlign:"left",py:1.5},children:e.jsx("strong",{children:"Book Title"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1.5},children:e.jsx("strong",{children:"Accession No"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1.5},children:e.jsx("strong",{children:"Issue Date"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1.5},children:e.jsx("strong",{children:"Return Date"})})]})}),e.jsx(xe,{children:S.map((r,C)=>e.jsxs(z,{children:[e.jsx(n,{sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:r.Book_Title}),e.jsx(n,{sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:r.Accession_No}),e.jsx(n,{sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:r.Issue_Date}),e.jsx(n,{sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:r.Return_Date})]},C))})]})}),j>19?e.jsx(ue,{ChangeRowsPerPage:f,rowsPerPageOptions:[b],rowsPerPage:m,PageChange:s,pagecount:y}):e.jsx("span",{})]})},os=()=>{const i=le(),m=De();a.useState("");const[k,T]=a.useState(2),[d,b]=a.useState("Asc"),[h,D]=a.useState(""),[f,s]=a.useState(""),[c,x]=a.useState(""),[S,y]=a.useState(""),[j,r]=a.useState("0"),[C,w]=a.useState(""),[_,G]=a.useState("");a.useState([]);const[v,p]=a.useState(""),[u,Y]=a.useState(20),[g,F]=a.useState(1),$=[20,50,100,200],[Q,H]=a.useState(0),[t,se]=a.useState([{Id:1,Header:"Accession No",SortOrder:null,sortKey:"Book_No"},{Id:2,Header:"Book Title",SortOrder:null,sortKey:"Book_Title"},{Id:3,Header:"Author",SortOrder:"ASC",sortKey:"Author_Name"},{Id:4,Header:"Publisher",SortOrder:null,sortKey:"Published_By"},{Id:5,Header:"Standards"},{Id:6,Header:"Language",SortOrder:null,sortKey:"Language"},{Id:7,Header:"Available"},{Id:8,Header:"Total"},{Id:9,Header:"Claim"}]),P=Number(localStorage.getItem("localSchoolId")),N=Number(localStorage.getItem("UserId")),M=Number(sessionStorage.getItem("AcademicYearId")),te=I(o=>o.SchoolLibrary.IGetLibraryBookIssueDetails),q=I(o=>o.SchoolLibrary.IBookClimedMsg);I(o=>o.SchoolLibrary.IGetReserveBookDetails);const E=I(o=>o.SchoolLibrary.IreserveBooksCountperperson),O=I(o=>o.SchoolLibrary.IGetAllBooksDetailss),J=I(o=>o.SchoolLibrary.IGetBookTotalCount);I(o=>o.SchoolLibrary.IGetTotalBookID);const he=(Array.isArray(O)?O.filter(o=>o.USGetBookTotalCount!==void 0):[]).map(o=>o.USGetBookTotalCount);[...new Set(he)];const X=()=>{let o="";return t.map(L=>{L.Id==k&&(o=L.sortKey)}),o},oe={asprm_iSchoolId:P,Book_Title:h,Author_Name:c,Published_By:S,AccessionNumber:f,Language:C,Is_Printable:_,asprm_iStandardId:j,asSortExp:"Order By "+X()+" "+d,asStartIndex:(g-1)*u,asEndIndex:g*u,asprm_iParentStaffId:0},pe=()=>{i(ee(oe))};a.useEffect(()=>{i(ee(oe))},[i,g,u,d,k]);const ge={asSchool_Id:P,asBook_Issued_To:N,asAcademic_Year_Id:M},me={asprm_iSchoolId:P,asprm_Filter:"",asprm_BookNo:"",asprm_iStandardId:0,asprm_iParentStaffId:0},je={asSchoolId:P,asAcademicYearId:M,asUserID:N,asStartIndex:(g-1)*u,asEndIndex:g*u,asBookTitle:"",asUserName:"",asSortExpression:"Order By "+X()+" "+d,asAllUserFlag:0};a.useEffect(()=>{v&&p("")},[g,u,d,k]),a.useEffect(()=>{p(""),i(Pe(je)),i(_e(ge)),i(Le(me))},[]);const Ie=o=>{H(o),i(Ge({asSchoolId:P,asAcademicYearId:M,asBookId:o,asUserId:N,asFlag:0}))};a.useEffect(()=>{let o=!0;if(E.length>0){if(E[0].Count==="999"&&(p("Could not claim same book."),o=!1),E[0].Count==="4"&&(p("Cannot claim more than 4 books."),o=!1),!o)return;i(ve({asBookId:Q,asUserId:N,asReservedByParent:0,asSchoolId:P,asAcademicYearId:M,asInsertedById:N})),H(0),i(Ne())}},[E]),a.useEffect(()=>{q!==""&&(Ee.success(q),i(Re()),p(""))},[q,E]);const R=a.useMemo(()=>Array.isArray(J)?J.reduce((o,L)=>{const re=Number(L.TotalCount);return isNaN(re)?o:o+re},0):0,[J]),be=o=>{F(o)},ke=o=>{Y(parseInt(o.target.value,10)),F(1)},fe=(g-1)*u+1,ae=Math.min(g*u,R),Se=Math.ceil(R/u),Be=o=>{T(o.Id),b(o.SortOrder)};a.useEffect(()=>{p("")},[]);const ye=()=>{D(""),s(""),x(""),y(""),r("0"),w("0"),G(""),p("");const o={asprm_iSchoolId:P,Book_Title:h,Author_Name:c,Published_By:S,AccessionNumber:f,Language:C,Is_Printable:_,asprm_iStandardId:j,asSortExp:"Order By "+X()+" "+d,asStartIndex:(g-1)*u,asEndIndex:g*u,asprm_iParentStaffId:0};i(ee(o)),setTimeout(()=>{window.location.reload()},1e3)};return e.jsxs(l,{px:2,children:[e.jsx(we,{navLinks:[{title:"Library",path:"/RITeSchool/Teacher/LibraryBaseScreen"}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Here you can search the books and also you can see the issued book details.",children:e.jsx(V,{sx:{color:"white",backgroundColor:ne[500],"&:hover":{backgroundColor:ne[600]}},children:e.jsx(Ke,{})})}),e.jsx(K,{title:"Claimed Book Details",children:e.jsx(V,{sx:{color:"white",backgroundColor:W[500],"&:hover":{backgroundColor:W[600]}},onClick:()=>m("/RITeSchool/Teacher/ClaimedBookDetailsPage/",{state:{fromInternal:!0}}),children:e.jsx(Fe,{})})})]})}),e.jsx(l,{pb:.5,children:v&&e.jsxs("span",{style:{color:"red",fontWeight:"bolder"},children:[v,e.jsx("br",{})]})}),e.jsx(Ve,{BookTitle:h,AccessionNumber:f,Author:c,Publisher:S,StandardId:j,LanguageId:C,IsPrintable:_,setBookTitle:D,setAccessionNumber:s,setAuthor:x,setPublisher:y,setStandardId:r,setLanguageId:w,setIsPrintable:G,clickSearch:pe,clickReset:ye}),e.jsx(l,{mt:1,px:2,sx:{background:"white",p:2},children:e.jsxs(l,{sx:{display:"flex",gap:"20px",alignItems:"center"},children:[e.jsx(A,{variant:"h4",sx:{mb:0,lineHeight:"normal",alignSelf:"center",paddingBottom:"2px"},children:"Legend"}),e.jsx(l,{sx:{display:"flex",gap:"20px"},children:e.jsx(l,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(A,{sx:{color:"red"},children:"Can not be issued"})})})]})}),e.jsxs(l,{mt:1,px:2,sx:{backgroundColor:"white"},pb:2,children:[e.jsxs(l,{sx:{display:"flex"},children:[e.jsx(l,{children:e.jsx(A,{variant:"h4",pt:2,color:"#38548A",children:"Books Details"})}),R>0?e.jsx(l,{style:{flex:1,textAlign:"center"},children:e.jsxs(A,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(l,{component:"span",fontWeight:"fontWeightBold",children:[fe," to ",ae]})," ","out of"," ",e.jsx(l,{component:"span",fontWeight:"fontWeightBold",children:R})," ",R===1?"record":"records"]})}):e.jsx("span",{children:" "})]}),O.length===0?e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(A,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx(Ye,{data:O,clickcliam:Ie,DefaultValue:d,handleSortChange:Be,HeaderArray:t,sortHeader:k,SortExpression:d}),ae>19?e.jsx(ue,{rowsPerPage:u,ChangeRowsPerPage:ke,rowsPerPageOptions:$,PageChange:be,pagecount:Se}):e.jsx("span",{})]}),e.jsxs(l,{mt:1,p:2,sx:{backgroundColor:"white"},children:[e.jsx(A,{variant:"h4",pb:1,color:"#38548A",children:"Books With Me"}),te.length===0?e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(A,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx($e,{data1:te})]})]})};export{os as default};
