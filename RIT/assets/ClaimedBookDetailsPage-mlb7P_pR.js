import{j as e,B as h,af as le,c1 as ne,ag as ie,ah as ce,ai as G,aj as a,ak as xe,I,ap as P,E as S,u as de,r as o,z as he,c as v,ns as j,t as me,nz as ue,C as pe,n as ge,G as U,o as _,nA as je,F as H,T as K,c7 as Ce,bH as fe,av as ke,nB as ye}from"./index-CpZD2H93.js";import{d as C}from"./ArrowCircleUp-C3u-oYJu.js";import{d as be}from"./Close-7OiSXahc.js";import{A as f}from"./ArrowCircleDown-7BHmj5tB.js";import{S as we}from"./SearchTwoTone-BuZBJscN.js";import{Q as Te}from"./QuestionMark-B_7MKkiz.js";const Be=({data:r,showAllUsers:k,handleDelete:y,handleSortChange:l,SortBy:n,SortDirection:i})=>{const c=Array.isArray(r)?r:[];return e.jsx(h,{children:e.jsx(le,{component:ne,children:e.jsxs(ie,{"aria-label":"simple table",sx:{border:t=>`1px solid ${t.palette.divider}`},children:[e.jsx(ce,{children:e.jsxs(G,{sx:{background:t=>t.palette.secondary.main},children:[e.jsx(a,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>l("Book_Title"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Book Title ",n==="Book_Title"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),k&&e.jsxs(e.Fragment,{children:[e.jsx(a,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>l("Name"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["User Name ",n==="Name"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>l("Class"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Class ",n==="Class"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white !important",py:1.5},children:e.jsxs("b",{onClick:()=>l("Designation"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Designation ",n==="Designation"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})})]}),e.jsx(a,{sx:{color:"white",py:1.5,pl:4},children:e.jsxs("b",{onClick:()=>l("ReservationDate"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Date",n==="ReservationDate"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white",py:1.5,textAlign:"center"},children:e.jsx("b",{children:"Cancel"})})]})}),e.jsx(xe,{children:c.map((t,m)=>e.jsxs(G,{sx:{height:"10px","& .MuiTableCell-root":{padding:"2px"}},children:[e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:t.bookTitle}),k&&e.jsxs(e.Fragment,{children:[e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:t.userName}),e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:t.class}),e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:t.designation})]}),e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:t.date}),e.jsx(a,{sx:{textTransform:"capitalize",textAlign:"center",opacity:1,py:.5},align:"center",children:t.UserId==localStorage.getItem("UserId")&&e.jsx(I,{onClick:()=>y(t.BookId),sx:{color:"#223354","&:hover":{color:"red",backgroundColor:P[100]}},children:e.jsx(S,{title:"Cancel",children:e.jsx(be,{})})})})]},m))})]})})})},Ue=()=>{const r=de(),{showAlert:k,closeAlert:y}=o.useContext(he),l=Number(localStorage.getItem("localSchoolId")),n=Number(localStorage.getItem("UserId")),i=Number(sessionStorage.getItem("AcademicYearId")),[c,t]=o.useState(!1),[m,L]=o.useState(""),[b,M]=o.useState(""),[w,E]=o.useState("asc"),[T,O]=o.useState("Book_Title"),[d,Q]=o.useState(20),[B,z]=o.useState(1),[V,u]=o.useState([]),Y=[20,50,100,200],D=v(s=>s.SchoolLibrary.ICancelBookReservationMsg),x=v(s=>s.SchoolLibrary.IGetReserveBookDetails),p=v(s=>s.SchoolLibrary.IGetReserveBookDetailsCount).map(s=>s.Count);v(s=>s.SchoolLibrary.Loading);const $=s=>{z(s)},q=s=>{Q(parseInt(s.target.value,20)),z(1)},J=(B-1)*d+1,F=Math.min(B*d,p),X=Math.ceil(p/d),Z=s=>{T===s?E(w==="asc"?"desc":"asc"):(O(s),E("asc"))},A=(B-1)*d,W=A+d,g={asSchoolId:l,asAcademicYearId:i,asUserID:n,asStartIndex:A,asEndIndex:W,asBookTitle:m,asUserName:b,asSortExpression:"Order By "+T+" "+w,asAllUserFlag:c==!0?1:0};o.useEffect(()=>{r(j(g))},[c,B,w,T,A,W]);const ee=()=>{t(!c)};o.useEffect(()=>{u(x)},[x]);const se=s=>{L(s)},te=s=>{M(s)},ae=()=>{u(m===""?x:x.filter(s=>s.bookTitle.toLowerCase().includes(m.toLowerCase()))),r(j(g))},R=()=>{ae(),u(b===""?x:x.filter(s=>s.userName.toLowerCase().includes(b.toLowerCase()))),r(j(g))},oe=()=>{L(""),M("");const s={...g,asBookTitle:"",asUserName:"",asAllUserFlag:c==!0?1:0,asStartIndex:0,asEndIndex:d};r(j(s))},re=s=>{if(!s)return;const N={asSchoolId:l,asAcademicYearId:i,asUserId:n,asBookid:Number(s)};k({title:"Please Confirm",message:"Are you sure you want to cancel the book claim?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{y()},onConfirm:()=>{r(ye(N)),y()}})};return o.useEffect(()=>{D!==""&&(me.success(D),r(ue()),r(j(g)))},[D]),e.jsxs(h,{px:2,children:[e.jsx(pe,{navLinks:[{title:"Library",path:"/RITeSchool/Teacher/LibraryBaseScreen"},{title:"Claimed Book Details",path:"/RITeSchool/Teacher/LibraryBaseScreen/ClaimedBookDetailsPage"}],rightActions:e.jsxs(ge,{direction:{xs:"column",sm:"row"},alignItems:"right",spacing:2,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(U,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(_,{fullWidth:!0,label:"User Name",variant:"outlined",size:"small",sx:{width:{xs:"50vw",sm:"10vw"}},onChange:s=>{te(s.target.value)},value:b,onKeyDown:s=>{(s.key==="Enter"||s.key==="Tab")&&R()}})}),e.jsx(U,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(_,{fullWidth:!0,label:"Book Title",variant:"outlined",size:"small",sx:{width:{xs:"50vw",sm:"13vw"}},onChange:s=>{se(s.target.value)},value:m,onKeyDown:s=>{(s.key==="Enter"||s.key==="Tab")&&R()}})}),e.jsxs(U,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:[e.jsx(S,{title:"Search",children:e.jsx(I,{onClick:R,sx:{background:s=>s.palette.primary.main,color:"white","&:hover":{backgroundColor:s=>s.palette.primary.dark}},children:e.jsx(we,{})})}),e.jsx(S,{title:"Clear",children:e.jsx(I,{sx:{color:"white",backgroundColor:P[500],height:"36px !important",":hover":{backgroundColor:P[600]}},onClick:oe,children:e.jsx(je,{})})}),e.jsx(S,{title:"Displays the books claimed by user and user can cancel the book claim.",children:e.jsx(I,{sx:{color:"white",backgroundColor:H[500],"&:hover":{backgroundColor:H[600]}},children:e.jsx(Te,{})})})]})]})}),e.jsx(h,{sx:{backgroundColor:"white",p:2},children:x&&x.length===0?e.jsx(h,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(K,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{control:e.jsx(fe,{checked:c,onChange:ee}),label:"Show all claimed books by all users",sx:{mb:2}}),p>0?e.jsx(h,{style:{flex:1,textAlign:"center"},children:e.jsxs(K,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(h,{component:"span",fontWeight:"fontWeightBold",children:[J," to ",F]})," ","out of"," ",e.jsx(h,{component:"span",fontWeight:"fontWeightBold",children:p})," ",p===1?"record":"records"]})}):e.jsx("span",{children:" "}),e.jsx(Be,{data:V,showAllUsers:c,handleDelete:re,handleSortChange:Z,SortBy:T,SortDirection:w}),F>19?e.jsx(ke,{rowsPerPage:d,ChangeRowsPerPage:q,rowsPerPageOptions:Y,PageChange:$,pagecount:X}):e.jsx("span",{})]})})]})};export{Ue as default};
