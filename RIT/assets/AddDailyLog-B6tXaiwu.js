import{j as e,af as ze,B as n,ag as Ye,ah as _e,ai as ae,aj as j,ak as $e,J as R,ap as oe,E as S,hd as Ve,I as P,ao as Xe,aq as Je,u as qe,A as Qe,q as Ke,v as X,r as a,z as Ze,c as D,cm as et,hQ as tt,aJ as re,hR as b,t as N,hS as st,hT as at,hU as ot,C as rt,ay as ne,F as le,H as nt,au as lt,a0 as it,a1 as ct,bd as dt,a3 as xt,n as ut,G as u,o as ht,aG as ie,aH as ce,a5 as gt,a6 as de,dk as mt,T as xe,av as pt,hV as ft,hW as jt,hX as Dt}from"./index-CpZD2H93.js";import{S as bt}from"./SingleFile-VnBjWcb-.js";import{B as St}from"./ButtonStyle-DAEB_dBE.js";import{d as yt}from"./ArrowCircleUp-C3u-oYJu.js";import{d as Ct}from"./PublishedWithChanges-Drrz32MI.js";import{A as It}from"./ArrowCircleDown-7BHmj5tB.js";import{L as wt}from"./Link-QB4wltBd.js";import"./CloudUpload-C2WsbpCZ.js";import"./Errormessage-DVJGTehf.js";function kt({ItemList:r,clickView:d,HeaderArray:i,clickEdit:y,clickDelete:c,clickpublish:x,ClickHeader:h}){const U=s=>{s!=null&&(i=i.map(l=>l.SortOrder==null?l:{...l,SortOrder:l.SortOrder==" Asc"?" Desc":" Asc"}),h(i))};return e.jsx("div",{children:e.jsx(ze,{component:n,sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:e.jsxs(Ye,{"aria-label":"simple table",children:[e.jsx(_e,{children:e.jsx(ae,{sx:{backgroundColor:s=>s.colors.secondary.main,color:s=>s.palette.common.white},children:i.map((s,l)=>e.jsx(j,{sx:{textTransform:"capitalize",color:C=>C.palette.common.white,py:1},onClick:()=>{U(s.Id)},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:1,justifyContent:s!=null&&s.align?"center":"flex-start"},children:[e.jsx("b",{children:s.Header}),s.SortOrder!=null?s.SortOrder==" Desc"?e.jsx(yt,{}):e.jsx(It,{}):null]})},l))})}),e.jsx($e,{children:r.map(s=>e.jsxs(ae,{children:[e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Text1}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:e.jsx(wt,{href:"",onClick:()=>d(s.Text2),children:"view log"})}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:e.jsx(St,{style:{backgroundColor:s.Text3==="False"?R[500]:oe[500]},onClick:()=>x(s.Id,s.Text3),sx:{minWidth:"10px",marginLeft:"40px"},children:s.Text3==="False"?e.jsx(S,{title:"Publish",children:e.jsx(Ct,{})}):e.jsx(S,{title:"Unpublish",children:e.jsx(Ve,{})})})}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},align:"center",children:s.Text3==="False"?e.jsx(S,{title:"Edit",children:e.jsx(P,{onClick:()=>y(s.Id),sx:{cursor:"pointer","&:hover":{backgroundColor:"lightgrey"}},children:e.jsx(Xe,{})})}):null}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},align:"center",children:s.Text3==="False"?e.jsx(S,{title:"Delete",children:e.jsxs(P,{onClick:()=>c(s.Id),sx:{color:"#223354","&:hover":{color:"red",backgroundColor:oe[100]}},children:["   ",e.jsx(Je,{})," "]})}):null})]},s.Id))})]})})})}const Rt=()=>{var se;const r=qe();Qe();let{Id:d,ClassName:i,SelectTeacher:y}=Ke();d=X(d),i=X(i),y=X(y);const[c,x]=a.useState(""),[h,U]=a.useState(""),[s,l]=a.useState(""),[C,g]=a.useState(""),[I,v]=a.useState(""),[J,F]=a.useState(""),[q,Q]=a.useState(""),[G,M]=a.useState(0),[m,K]=a.useState(1),[w,ue]=a.useState(20),he=[20,50,100,200],ge=5e6,Z=(m-1)*20,me=Z+20,k=Number(localStorage.getItem("localSchoolId")),H=Number(sessionStorage.getItem("AcademicYearId")),pe=Number(localStorage.getItem("UserId")),O=Number(sessionStorage.getItem("TeacherId")),ee=localStorage.getItem("SiteURL");ee.split("/")[ee.split("/").length-1],a.useState(!0);const{showAlert:te,closeAlert:B}=a.useContext(Ze),T=D(t=>t.AddDailyLog.Savelog),A=D(t=>t.AddDailyLog.GetAllHomework),L=A.map(t=>t.TotalRows),E=D(t=>t.AddDailyLog.GetHomeworkDailyLog),W=D(t=>t.AddDailyLog.DeleteHomework),z=D(t=>t.AddDailyLog.PublishUnpublish),fe=D(t=>t.AddDailyLog.ISGetfile),[Y,je]=a.useState([{Id:1,Header:"Date",SortOrder:" Desc"},{Id:2,Header:"Attachment"},{Id:3,Header:"Publish / Unpublish"},{Id:4,Header:"Edit",align:"center"},{Id:5,Header:"Delete",align:"center"}]),De=["BMP","DOC","DOCX","JPG","JPEG","PNG","BMP","PDF","XLS","XLSX"],be=a.useCallback(et(t=>{r(tt(t))},500),[r]),Se=c?re(new Date(c)):"",ye={aHomeWorkLogId:G,asStdDivId:Number(d),asDate:Se,asAttachmentName:I==""?null:I,asSchoolId:k,asAcademicYearId:Number(H),asInsertedById:O,asSaveFeature:"Assign Homework",asFolderName:"PPSN Website",asBase64String:q==""?null:q},Ce=h?re(new Date(h)):"",p={asSchoolId:k,asFilter:Ce,asStdDivId:Number(d),asSortExpression:"Date "+Y[0].SortOrder,asStartIndex:Z,asEndIndex:me,asUserId:pe},Ie=(t,o)=>{const f={asSchoolId:Number(k),asAcademicYearId:Number(H),asLogId:t,asUpdatedById:O,asIsPublished:o==="False"};te({title:"Please Confirm",message:o==="False"?"Are you sure you want to publish record?":"Are you sure you want to unpublish record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{B()},onConfirm:()=>{r(ft(f)),B()}})};a.useEffect(()=>{r(b(p))},[Y,m]);const _=20;a.useState(1),a.useEffect(()=>{const t=(m-1)*_,o=t+_,f={...p,asStartIndex:t,asEndIndex:o};r(b(f))},[m]),Math.ceil(((se=A[0])==null?void 0:se.TotalRows)/_),a.useEffect(()=>{z!=""&&(N.success(z),r(st()),r(b(p)))},[z]),a.useEffect(()=>{if(E.length>0){let t=E[0].Date.split(" ")[0],o=t.split("-")[2]+"-"+t.split("-")[1]+"-"+t.split("-")[0];x(o),v(E[0].AttchmentName)}},[E]);const we=t=>{M(t);const o={asSchoolId:Number(k),asAcademicYearId:Number(H),aId:t};$(!0),r(jt(o))},ke=t=>{const o={asSchoolId:Number(k),asAcademicYearId:Number(H),asId:t,asUpdatedById:O};te({title:"Please Confirm",message:"Are you sure you want to delete this record?  ",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{B()},onConfirm:()=>{r(Dt(o)),B()}})};a.useEffect(()=>{W!==""&&(N.success(W,{toastId:"success1"}),r(at()),r(b(p)))},[W]);const Te=t=>{fe!==""&&window.open(localStorage.getItem("SiteURL")+"/RITeSchool/DOWNLOADS/Homework/DailyLog/"+t)},Ae=t=>{x(t),t&&C!==""&&g("")},Le=t=>{U(t)},Pe=t=>{v(t.Name),Q(t.Value),F("")},ve=()=>{x(""),v(""),Q(""),M(0)},Fe=()=>{let t=!1;!c||c===""?(g("Date should not be blank."),t=!0):(g(""),new Date(c)>new Date?(g("Future date is not allowed."),t=!0):g("")),!I||I===""?(F("Please select file to upload."),t=!0):F(""),t||(be(ye),ve())};a.useEffect(()=>{T!=""&&(T=="Record for given date is already exist."?N.error(T):N.success(T),r(ot()),r(b(p)))},[T]),a.useEffect(()=>{(()=>{const f=new Date().toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});x(f)})()},[]);const He=t=>{const o=new Date;return o.setHours(0,0,0,0),t.setHours(0,0,0,0),t>o},Be=()=>{const t=new Date(h);He(t)?l("Future dates are selected."):l(""),r(b(p))},Ee=t=>{je(t)},[Ne,$]=a.useState(!1),Re=t=>{$(!0)},V=t=>{$(!1),v(""),x(""),g(""),F(""),M(0)},Ue=(m-1)*w+1,Ge=Math.min(m*w,L[0]),Me=Math.ceil(L[0]/w),Oe=t=>{ue(parseInt(t.target.value,10)),K(1)},We=t=>{K(t)};return e.jsx(e.Fragment,{children:e.jsxs(n,{sx:{px:2},children:[e.jsx(rt,{navLinks:[{title:"Assign Homework",path:"/RITeSchool/Teacher/AssignHomework/"+ne(d)+"/"+ne(y)},{title:"Manage Daily Log",path:""}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsx(S,{title:"Display / Add / Edit / Delete homework log of respective class.",children:e.jsx(P,{sx:{color:"white",backgroundColor:le[500],height:"36px !important",":hover":{backgroundColor:le[600]}},children:e.jsx(nt,{})})})}),e.jsx(n,{children:e.jsx(S,{title:"Add Daily Log",children:e.jsx(P,{sx:{color:"white",backgroundColor:R[500],height:"36px !important",":hover":{backgroundColor:R[600]}},onClick:Re,children:e.jsx(lt,{})})})})]})}),e.jsxs(it,{open:Ne,maxWidth:"md",fullWidth:!0,onClose:V,PaperProps:{sx:{borderRadius:"15px"}},children:[e.jsx(ct,{sx:{bgcolor:"#223354",color:t=>t.palette.common.white},children:e.jsx(dt,{onClick:V,sx:{color:"white",borderRadius:"7px",position:"absolute",top:"5px",right:"7px",cursor:"pointer","&:hover":{color:"red"}}})}),e.jsx(xt,{children:e.jsxs(n,{sx:{maxHeight:"300px",position:"relative",background:"white"},children:[e.jsx("h1",{children:G==0?"Add Daily Log":"Edit Daily Log"}),e.jsx(ut,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:e.jsxs(u,{container:!0,spacing:2,mt:.5,children:[e.jsx(u,{item:!0,xs:12,sm:4,children:e.jsx(ht,{fullWidth:!0,label:"Class",sx:{bgcolor:"  #F0F0F0",width:"100%"},value:i})}),e.jsxs(u,{item:!0,xs:12,sm:4,children:[e.jsx(ie,{DateValue:c,onDateChange:Ae,label:"Date",size:"medium"}),C&&e.jsx(n,{sx:{mt:1,position:"absolute",bottom:"-25px"},children:e.jsx(ce,{Error:C})})]}),e.jsxs(u,{item:!0,xs:12,sm:4,children:[e.jsx(bt,{ValidFileTypes:De,MaxfileSize:ge,ChangeFile:Pe,errorMessage:"",FileName:I,height:"52.5px"}),J&&e.jsx(n,{sx:{mt:1,position:"absolute",bottom:"-25px"},children:e.jsx(ce,{Error:J})})]})]})})]})}),e.jsxs(gt,{sx:{py:2,px:3},children:[e.jsx(de,{color:"error",onClick:V,children:"Cancel"}),e.jsx(de,{onClick:Fe,sx:{color:"green","&:hover":{color:"green",backgroundColor:R[100]}},children:G==0?"Save":"Update"})]})]}),e.jsx(n,{sx:{backgroundColor:"white",p:2},children:e.jsxs(u,{container:!0,spacing:1,justifyContent:"flex-end",alignItems:"center",children:[e.jsx(u,{item:!0,xs:12,children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",justifyContent:"flex-end"},children:[e.jsx(n,{children:e.jsx(ie,{DateValue:h,onDateChange:Le,label:"",size:"small"})}),e.jsx(n,{children:e.jsx(P,{onClick:Be,sx:{background:t=>t.palette.primary.main,color:"white",mr:2},children:e.jsx(mt,{})})})]})}),e.jsxs(u,{item:!0,xs:12,children:[A.length>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(xe,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[Ue," to ",Ge]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:L[0]})," ",L[0]===1?"record":"records"]})}):e.jsx("span",{}),A.length>0?e.jsxs(e.Fragment,{children:[e.jsx(kt,{ItemList:A,clickView:Te,HeaderArray:Y,ClickHeader:Ee,clickEdit:we,clickDelete:ke,clickpublish:(t,o)=>Ie(t,o)}),L[0]>w?e.jsx(pt,{rowsPerPage:w,ChangeRowsPerPage:Oe,rowsPerPageOptions:he,PageChange:We,pagecount:Me}):e.jsx("span",{})]}):e.jsx(xe,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No record found."})})]})]})})]})})};export{Rt as default};
