import{S as X,A as Z,h as ee,t as u,r as o,c as R,u as te,d$ as se,e0 as oe,j as e,B as x,a7 as v,o as f,G as a}from"./index-CpZD2H93.js";import{u as ne}from"./formik.esm-Crucl9hw.js";import{E as M}from"./Errormessage-DVJGTehf.js";import{N as re}from"./Note-D5w6lthy.js";import{B as ae}from"./BackButton-D8aQMrwN.js";import{P as ie}from"./PageHeader-C9ChZO91.js";import{B as b}from"./ButtonStyle-DAEB_dBE.js";import{L as le,C as ce}from"./CardStyle-CBuNm0_N.js";import{A as de}from"./AddReciepents-nwWB8U-u.js";import{N as me}from"./NativeSelect-CZqztF8l.js";import"./Card-B0aZ7mGs.js";import"./GroupAdd-YcnFVjzY.js";import"./Square-CVQpjtQG.js";import"./ListSelect-CwnzciXr.js";import"./CheckboxImg-BrcA302U.js";import"./RadioButtonUnchecked-r_6mn_G1.js";import"./ArrowCircleUp-C3u-oYJu.js";import"./ArrowCircleDown-7BHmj5tB.js";import"./ListHeaderCard3ColSel-e-z25ypD.js";import"./DoNotDisturbOn-Dociqe_h.js";import"./QuestionMark-B_7MKkiz.js";const we=()=>{const N=X(),A=Z();ee(),u.configure();const[B,I]=o.useState("none"),[F,C]=o.useState("block"),[r,P]=o.useState({RecipientName:[],RecipientId:[]}),k=t=>{I("block"),C("none")},i=R(t=>t.getAComposeSMS.AComposeSMSTemplateList).GetSMSTemplates,[l,m]=o.useState(),[D,T]=o.useState(),[ue,E]=o.useState(),[L,p]=o.useState(0),[w,S]=o.useState(0),O=t=>{if(t.target.value!=""){const s=t.target.value.indexOf(","),y=t.target.value.slice(0,s),n=t.target.value.slice(s).replace(",","");n.length>=300&&u.error("More than 300 characters not allowed"),n.length>=1&&n.length<=160&&(p(1),m(n),T(y)),n.length>160&&(confirm("SMS will be send in 2 parts for each selected user(s). Are you sure to continue?"),p(2),m(n),T(y)),n.length==0&&p(0),S(n.length)}else m(""),S(0),p(0)},_=t=>{E(!1)},[Se,c]=o.useState(),G=t=>{t.target.length>0&&c(!1),t.target.length==0&&c(!0)},U=t=>{t.target.value.length==0&&c(!0),t.target.value.length>0&&c(!1)},W=t=>{c(!1)},V=te();R(t=>t.getASendSMS.ASendSMS);const Y=sessionStorage.getItem("AcademicYearId"),g=localStorage.getItem("localSchoolId"),j=sessionStorage.getItem("Id"),H=localStorage.getItem("SchoolName"),J=sessionStorage.getItem("RoleId"),h=JSON.parse(localStorage.getItem("SchoolSettingsValue")).SMSSenderUserName,$={asSchoolId:g,sortDirection:"asc",asShowSystemDefined:"Y"},d=ne({initialValues:{From:h,To:r.RecipientName.toString(),Content:l},onSubmit:()=>{q()},validate:t=>{const s={};return r.RecipientName.toString().length==0&&(s.To="Atleast one recipient should be selected."),(l==null||l=="")&&(s.Content="SMS content should not be blank please select SMS Template"),s}}),q=()=>{const t={asSchoolId:g,aoMessage:{Body:l,Subject:"",SenderName:h,DisplayText:r.RecipientName.toString(),SenderUserId:j,SenderUserRoleId:J,AcademicYearId:Y,SchoolId:g,InsertedById:j,Attachment:""},asSelectedUserIds:r.RecipientId.toString(),asSelectedStDivId:"",asIsSoftwareCordinator:0,asMessageId:0,sIsReply:"N",asIsForward:"N",asSchoolName:H,asTemplateRegistrationId:D};se.SendSMS(t).then(s=>{s.status===200&&(u.success("SMS sent successfully"),A("/RITeSchool/SMSCenter/smsCenter",{state:{fromInternal:!0}}),d.resetForm())}).catch(s=>{u.error("SMS does not sent successfully")})};o.useMemo(()=>{V(oe($))},[]);const z=["Do not use any website URL or mobile number in SMS text. Such SMS will not get delivered to selected recipient(s)."];o.useState(!1);const K=t=>{P(t),I("none"),C("block")},Q=t=>{m(t),S(t.length)};return e.jsxs(x,{sx:{px:2},children:[e.jsx(ie,{heading:"Compose SMS",subheading:""}),e.jsxs(x,{style:{display:F},children:[e.jsx(ae,{FromRoute:"/SMSCenter/smsCenter"}),e.jsxs(e.Fragment,{children:[e.jsx(le,{sx:{},children:e.jsxs("form",{onSubmit:d.handleSubmit,children:[e.jsxs(v,{fullWidth:!0,children:[e.jsx(f,{sx:{marginBottom:"-10px"},variant:"standard",name:"From",label:"From",id:"from",InputProps:{readOnly:!0},value:h}),e.jsx(x,{sx:{mt:"15px"},children:e.jsx(f,{name:"To",placeholder:"To",multiline:!0,className:N.InputField,onChange:G,onBlur:U,onFocus:W,InputProps:{readOnly:!0},value:r.RecipientName,variant:"outlined",id:"body",fullWidth:!0,margin:"normal",style:{scrollBehavior:"auto"},sx:{maxHeight:"60px",overflow:"auto"}})}),e.jsx("div",{style:{marginTop:"15px"},children:e.jsx(M,{Error:d.errors.To})})]}),e.jsx(a,{container:!0,children:e.jsx(a,{item:!0,md:3,children:e.jsx(b,{fullWidth:!0,onClick:k,children:"Add Recipients"})})}),e.jsx(a,{container:!0,style:{marginTop:"12px",marginBottom:"17px"},children:e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,children:e.jsxs(me,{onChange:O,style:{borderRadius:"2px solid black"},children:[e.jsx("option",{value:"",children:"Select SMS Template Name"}),i==null||i.length==0?null:i==null?void 0:i.map((t,s)=>e.jsx("option",{value:t.registration_Number+","+t.Template,children:t.Template_Name},s))]})})})}),e.jsxs(ce,{sx:{color:"blue",marginTop:1,marginBottom:1.5,fontWeight:"bold"},children:[" ","Letters = ",w," Message = ",L," "]}),e.jsx(f,{fullWidth:!0,multiline:!0,rows:4,margin:"normal",name:"Content",type:"text",value:l,onBlur:_,sx:{marginTop:"1px"},id:"content",onChange:t=>Q(t.target.value)}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(M,{Error:d.errors.Content})}),e.jsx("br",{}),e.jsx(a,{container:!0,children:e.jsx(a,{item:!0,xs:12,children:e.jsx(b,{type:"submit",fullWidth:!0,onClick:d.handleChange,children:"Send"})})})]})}),e.jsx(re,{NoteDetail:z})]})]}),e.jsx("div",{style:{display:B},children:e.jsx(de,{RecipientName:r.RecipientName,RecipientId:r.RecipientId,recipientListClick:K,contactGroupList:void 0,classIdList:void 0,IsConfirm:void 0,getGroupRadio:void 0,getGroupRadio1:void 0})})]})};export{we as default};
