import{U as Z,V as ee,j as s,s as pe,ai as H,aj as V,c1 as ns,af as os,ag as rs,ah as is,r as l,B as E,ak as ds,b9 as cs,u as us,A as hs,q as fs,v as xs,z as bs,ae as ps,c as r,I as S,ay as u,fl as gs,a9 as ms,iu as Ss,iv as Is,iw as Rs,ix as vs,iy as Cs,t as K,iz as js,iA as P,iB as F,iC as B,iD as Ts,iE as As,iF as Ps,iG as ys,iH as ws,iI as Gs,C as Ds,n as ks,G as xe,bI as Ns,E as y,F as be,H as _s,bl as b,bm as Fs,ap as Q,hd as Bs,iJ as Es,T as X,Q as Ls,av as Us,iK as $s,iL as Hs,iM as Vs}from"./index-CpZD2H93.js";import Ys from"./FinalResultUnpublish-BNrm6lPM.js";import{d as zs}from"./ArrowCircleUp-C3u-oYJu.js";import{A as Ms}from"./ArrowCircleDown-7BHmj5tB.js";var se={},Os=ee;Object.defineProperty(se,"__esModule",{value:!0});var ge=se.default=void 0,qs=Os(Z()),Ws=s,Js=(0,qs.default)((0,Ws.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");ge=se.default=Js;var te={},Ks=ee;Object.defineProperty(te,"__esModule",{value:!0});var me=te.default=void 0,Qs=Ks(Z()),Xs=s,Zs=(0,Qs.default)((0,Xs.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");me=te.default=Zs;var le={},et=ee;Object.defineProperty(le,"__esModule",{value:!0});var Se=le.default=void 0,st=et(Z()),tt=s,lt=(0,st.default)((0,tt.jsx)("path",{d:"m20.41 8.41-4.83-4.83c-.37-.37-.88-.58-1.41-.58H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.42zM7 7h7v2H7V7zm10 10H7v-2h10v2zm0-4H7v-2h10v2z"}),"TextSnippet");Se=le.default=lt;const at=pe(H)(({theme:t})=>`
  background-color: ${t.palette.secondary.main};
 `),nt=pe(V)(({theme:t})=>`
  color: white;
  font-weight: bold;
 `),ot=({columns:t,data:I,isLoading:p=!1,clickHeader:L,sortby:w,sortAsc:n})=>s.jsx(ns,{children:s.jsx(os,{children:s.jsxs(rs,{children:[s.jsx(is,{children:s.jsx(at,{children:t.map((x,R)=>l.createElement(nt,{...x.headerCellProps,key:x.id,onClick:()=>{R<t.length-3&&L(x.label)},style:{cursor:R<t.length-3?"pointer":"default"}},s.jsxs(E,{sx:{display:"flex",gap:.5},children:[x.renderHeader?x.renderHeader():x.label,x.label===w&&(n==="Desc"?s.jsx(zs,{}):s.jsx(Ms,{}))]})))})}),s.jsx(ds,{children:p?s.jsx(H,{children:s.jsx(V,{colSpan:t.length,align:"center",sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.jsx(cs,{})})}):I.length===0?s.jsx(H,{children:s.jsx(V,{colSpan:t.length,align:"center",sx:{paddingTop:"2.5px",paddingBottom:"2.5px"},children:"No data available"})}):I.map((x,R)=>s.jsx(H,{children:t.map(o=>l.createElement(V,{...o.cellProps,key:o.id,sx:{paddingTop:"2.5px",paddingBottom:"2.5px"}},o.renderCell(x)))},R))})]})})}),mt=()=>{var he,fe;const t=us(),I=hs();let{StandardDivisionId1:p}=fs();l.useEffect(()=>{p!==void 0&&(p=xs(p))},[p]);const[L,w]=l.useState(!1),n=Number(localStorage.getItem("localSchoolId")),{showAlert:x,closeAlert:R}=l.useContext(bs),o=Number(sessionStorage.getItem("AcademicYearId"));localStorage.getItem("Id");const Ie=Number(sessionStorage.getItem("TeacherId"));l.useState(""),l.useState(!0);const Re=sessionStorage.getItem("StandardDivisionId"),G=ps("Final Result");l.useState();const[ve,rt]=l.useState(),Y=Number(localStorage.getItem("UserId")),[Ce,it]=l.useState("Y"),[z,dt]=l.useState();l.useState(),l.useState();const[h,je]=l.useState(20),Te=[20,50,100,200],[g,ae]=l.useState(1),Ae=sessionStorage.getItem("RoleId"),Pe=sessionStorage.getItem("Id"),ye=["Final Result"],we=(e,f)=>{let m="";return e.map(A=>{A.Value==f&&(m=A.Name)}),m};r(e=>e.FinalResult.Loading);const i=r(e=>e.FinalResult.GetAtleastOneResultGenerated),d=r(e=>e.FinalResult.ISGetResultPublishd),v=r(e=>e.FinalResult.ClassTeachers),[a,ne]=l.useState(G==="Y"?"0":Re),c=a==="0",Ge=l.useMemo(()=>[{id:"rollNo",label:"Roll No.",renderCell:e=>e.Text1},{id:"studentName",label:"Student Name",renderCell:e=>e.Text2},{id:"total",label:"Total",renderCell:e=>e.Text3},{id:"percentage",label:"%",renderCell:e=>e.Text4},{id:"grade",label:"Grade",renderCell:e=>e.Text5},{id:"result",label:"Result",renderCell:e=>e.Text6},{id:"generate",label:"Generate",renderCell:e=>!d||c?s.jsx(S,{onClick:()=>{I("/RITeSchool/Teacher/GenerateAll/"+u(e.Id)+"/"+u(e.Text7)+"/"+u(!1)+"/"+u(a),{state:{fromInternal:!0}})},sx:{display:"flex",justifyContent:"center",alignItems:"center",ml:2},children:s.jsx(gs,{})}):null},{id:"view",label:"View",renderCell:e=>e.CanShowVisibility?s.jsx(S,{onClick:()=>{I("/RITeSchool/Teacher/GenerateAll/"+u(e.Id)+"/"+u("Y")+"/"+u(!0)+"/"+u(a),{state:{fromInternal:!0}})},sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:s.jsx(ms,{})}):null},{id:"grace",label:"Grace",renderCell:e=>e.grace}],[d,c]),C=r(e=>e.FinalResult.StudentResultList);C.map(e=>e.Is_ResultGenrated)[0];const oe=r(e=>e.FinalResult.StudentResultList1).NotGenratedResultCount,j=r(e=>e.ProgressReportNew.IsGetSchoolSettings),re=((he=j==null?void 0:j.GetSchoolSettingsResult)==null?void 0:he.BlockExamPublish)||"",De=((fe=j==null?void 0:j.GetSchoolSettingsResult)==null?void 0:fe.ShowTopppers)||"",M=r(e=>e.FinalResult.PublishResult),O=r(e=>e.FinalResult.UnpublishResult),q=r(e=>e.FinalResult.GenerateAll);r(e=>e.FinalResult.ViewResult),r(e=>e.FinalResult.Generate),r(e=>e.FinalResult.GetConfiguredTestPublished);const U=r(e=>e.FinalResult.GetTestPublished);i.length>0&&i[0].AllowPublish;const ke=r(e=>e.getSchoolSettings.getUserDetails),Ne=r(e=>e.FinalResult.iscofigred),ie=r(e=>e.FinalResult.unpublishexam),_e=C.filter(e=>e.TotalRows!==void 0).map(e=>e.TotalRows),D=[...new Set(_e)][0],Fe=(g-1)*h+1,de=Math.min(g*h,D),Be=Math.ceil(D/h),T=(g-1)*h,$=T+h;l.useEffect(()=>{t(Ss(Ve))},[z]),l.useEffect(()=>{t(Is(Ye))},[]),l.useEffect(()=>{const e={asSchoolId:String(n),asUserId:Pe,asRoleId:Ae};t(Rs(e))},[]);const Ee={asSchoolId:Number(n)},ce=()=>{let e=0;return v.map(f=>{f.Value==a&&(e=f.Id)}),e},[ue,Le]=l.useState("Roll No."),[W,Ue]=l.useState("Desc"),$e=e=>{Le(e),e===ue&&Ue(W==="Asc"?"Desc":"Asc");const f=W==="Desc"?" Desc":"",m=e==="Roll No."?"Roll_No":e==="Student Name"?"Name":e==="Total"?"Marks":e==="%"?"Percentage":e==="Grade"?"Grade_Name":e==="Result"?"Result":"",A={asSchoolId:n.toString(),asAcademicyearId:o.toString(),asStandardDivisionId:a,SortExp:`ORDER BY ${m}${f}`,prm_StartIndex:(g-1)*h,PageSize:g*h};t(P(A))},He={asSchoolId:n,asAcademicYearId:o,asTeacherId:G=="Y"?"0":Ie},k={asSchoolId:n.toString(),asAcademicyearId:o.toString(),asStandardDivisionId:a,SortExp:"ORDER BY Roll_No",prm_StartIndex:T,PageSize:$},Ve={asSchoolId:n,asAcademicYearId:o,asStudentId:z,asInsertedById:1,asWithGrace:0},Ye={asSchoolId:n,asAcadmeicYearId:o,asStudentId:z,asUserId:Y},ze={asSchoolId:n,asAcademicYrId:o,asStdDivId:Number(a)},N={asSchoolId:n,asAcadmicYearId:o,asStdDivId:Number(a)},Me={asSchoolId:n,asAcadmicYearId:o,asStdDivId:Number(a)},_={asSchoolId:n,asAcadmicYearId:o,asStdDivId:Number(a),asStandardId:0},Oe={asSchoolId:n,asAcademicYrId:o,asStdDivId:Number(a)},qe={asSchoolId:n,asAcademicYrId:o,asStdDivId:Number(a)},We=e=>{ne(e)},Je=()=>{let e=!1;return v.map(f=>{f.Value==a&&(e=f.StanderdId)}),e};l.useEffect(()=>{t(vs(He))},[ce()]);const Ke=Je();l.useEffect(()=>{p!==void 0&&ne(p)},[p]),l.useEffect(()=>{t(Cs(Ee))},[]);const Qe=e=>{I("/RITeSchool/Teacher/Toppers/"+u(ce())+"/"+u(a)+"/"+u(Ke)+"/"+u(!0),{state:{fromInternal:!0}})},Xe=()=>{w(!0)},Ze=()=>{w(!1)},es=e=>{ae(e)},ss=e=>{je(parseInt(e.target.value,10)),ae(1)},ts=(e,f="")=>{if(ve!==""){const m={asSchoolId:n,asAcademicYearId:o,asStandardDivId:Number(a),asUnPublishReason:e?null:f};t($s(m)),t(F(N)),t(P(k))}},ls=()=>{const e={asSchoolId:n,asAcademicYearId:o,asStdDivId:Number(a),asUserId:Y,asUseAvarageFinalResult:Ce};t(Hs(e))},as=e=>{if(e){C.map(J=>J.Is_ResultGenrated).filter(J=>J!=="Y").length;const m={asSchoolId:n,asAcademicYrId:o,asStandardDivision_Id:Number(a),asInsertedById:Y},A=oe>0?`Result of ${oe} students is not generated. Once you publish the result, it will be visible to parents/students. Are you sure you want to continue?`:"Once you publish the result it will be visible to parents/students. Are you sure you want to continue?";x({title:"Please Confirm",message:A,variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{R()},onConfirm:()=>{t(Vs(m)),t(F(N)),R()}})}};return l.useEffect(()=>{O!==""&&(K.success(O),t(js()),t(P(k)),t(F(N)),t(B(_)))},[g,h,O,T,$]),l.useEffect(()=>{q!==""&&(K.success(q),t(Ts()),t(P(k)),t(F(N)),t(B(_)))},[g,h,q,T,$]),l.useEffect(()=>{M!==""&&(K.success(M),t(As()),t(P(k)),t(B(_)))},[g,h,M,T]),l.useEffect(()=>{a!="0"&&(t(Ps(ze)),t(ys(Me)),t(B(_)),t(ws(Oe)),t(Gs(qe)),t(P(k)))},[g,h,a,T,$]),l.useEffect(()=>{t(B(_))},[a]),l.useEffect(()=>{t(F(N))},[a]),s.jsxs(E,{sx:{px:2},children:[s.jsx(Ds,{navLinks:[{title:"Final Result",path:""}],rightActions:s.jsxs(ks,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"left",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[s.jsx(xe,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(Ns,{sx:{width:{xs:"70vw",sm:"20vw"},bgcolor:G==="N"&&v.length==2?"#F0F0F0":"inherit"},ItemList:v,onChange:We,label:"Teacher",defaultValue:a,DisableClearable:G==="N"&&v.length==2,disabled:G==="N"&&v.length==2,mandatory:!0,size:"small"})}),s.jsxs(xe,{item:!0,xs:12,sm:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:[s.jsx(y,{title:'Display student list for their result generation. Click on "Generate All" to generate final results for all the students in the selected class. Click on "Publish" to publish the final result of the selected class. Click on "Publish All" to publish the final results of all the classes in your school.',children:s.jsx(S,{sx:{color:"white",backgroundColor:be[500],"&:hover":{backgroundColor:be[600]}},children:s.jsx(_s,{})})}),s.jsx(y,{title:"Generate All",disableHoverListener:!1,disableFocusListener:!1,children:s.jsx("span",{children:s.jsx(S,{onClick:ls,disabled:U==!1||d==!0||c,sx:{color:"white",backgroundColor:d?b[200]:b[500],"&:hover":{backgroundColor:b[600]},...(U==!1||d==!0||c)&&{pointerEvents:"none"}},children:s.jsx(ge,{})})})}),s.jsx(y,{title:"View Result All",disableHoverListener:!1,disableFocusListener:!1,children:s.jsx("span",{children:s.jsx(S,{onClick:()=>{I("/RITeSchool/Teacher/ViewResultAll/"+u(a),{state:{fromInternal:!0}})},disabled:(i==null?void 0:i.AllowPublish)==!1||c,sx:{color:"white",backgroundColor:(i==null?void 0:i.AllowPublish)==!1?b[200]:b[500],"&:hover":{backgroundColor:b[600]},...((i==null?void 0:i.AllowPublish)==!1||c)&&{pointerEvents:"none"}},children:s.jsx(Se,{})})})}),ke.CanPublishUnpublishExam==!0&&s.jsxs(s.Fragment,{children:[s.jsx(y,{title:"Publish",disableHoverListener:!1,disableFocusListener:!1,children:s.jsx("span",{children:s.jsx(S,{onClick:()=>as(!0),disabled:d==!0||i.AllowPublish==!1||re||c,sx:{color:"white",backgroundColor:d==!0||i.AllowPublish==!1||re||c?b[200]:b[500],"&:hover":{backgroundColor:b[600]},...(d==!0||i.AllowPublish==!1||c)&&{pointerEvents:"none"}},children:s.jsx(Fs,{})})})}),s.jsx(y,{title:"Unpublish",disableHoverListener:!1,disableFocusListener:!1,children:s.jsx("span",{children:s.jsx(S,{onClick:Xe,disabled:!d||c,sx:{color:"white",backgroundColor:d?Q[500]:Q[200],"&:hover":{backgroundColor:Q[600]},...(!d||c)&&{pointerEvents:"none"}},children:s.jsx(Bs,{})})})})]}),De==!0&&s.jsx(y,{title:"Toppers",disableHoverListener:!1,disableFocusListener:!1,children:s.jsx("span",{children:s.jsx(S,{onClick:Qe,disabled:d==!1&&i.AllowPublish==!1||c,sx:{color:"white",backgroundColor:b[500],"&:hover":{backgroundColor:b[600]},...(d==!1&&i.AllowPublish==!1||c)&&{pointerEvents:"none"}},children:s.jsx(Es,{})})})})]})]})}),U==!1?s.jsx(X,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:s.jsx("b",{children:"No exam of this class has been published for the current academic year."})}):null,C.length>0&&U==!0?s.jsxs(E,{sx:{background:"white",p:2},children:[s.jsx(X,{variant:"h6",textAlign:"center",color:"primary",mb:2,children:Ne.IsConfiged==0?s.jsx("div",{children:ie.length>0&&s.jsx(Ls,{variant:"filled",color:"info",sx:{mb:2},icon:s.jsx(me,{}),children:s.jsxs("b",{style:{color:"blue"},children:[" All configured exams are not published - ",ie.map(e=>e.SchoolWise_Test_Name).join(", ")]})})}):s.jsx("span",{children:" "})}),D>0?s.jsx("div",{style:{flex:1,textAlign:"center"},children:s.jsxs(X,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[s.jsxs(E,{component:"span",fontWeight:"fontWeightBold",children:[Fe," to ",de]})," ","out of"," ",s.jsx(E,{component:"span",fontWeight:"fontWeightBold",children:D})," ",D===1?"record":"records"]})}):s.jsx("span",{children:" "}),C&&C.length>0&&s.jsx(ot,{columns:Ge,data:C,clickHeader:$e,sortby:ue,sortAsc:W}),de>19?s.jsx(Us,{rowsPerPage:h,ChangeRowsPerPage:ss,rowsPerPageOptions:Te,PageChange:es,pagecount:Be}):s.jsx("span",{}),L&&s.jsx(Ys,{open:L,setOpen:w,ClickCloseDialogBox:Ze,onClickUnpublish:ts,ExamName:ye,TeacherName:we(v,a)})]}):s.jsx("span",{})]})};export{mt as default};
