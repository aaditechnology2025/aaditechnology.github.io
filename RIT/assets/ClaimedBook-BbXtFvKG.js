import{j as e,B as g,T as x,r,S as E,h as L,bV as w,L as P,N as Y,O as F,G as m,o as S,c7 as G,bH as _,u as H,c as k,ab as O,fd as y,t as $,fe as M,l as W,ff as z}from"./index-CpZD2H93.js";import{E as V}from"./ErrorMessages-Cl09dz4o.js";import{B as q}from"./BackButton-D8aQMrwN.js";import{P as J}from"./PageHeader-C9ChZO91.js";import{B}from"./ButtonStyle-DAEB_dBE.js";import{L as I}from"./CardStyle-CBuNm0_N.js";import{e as K,f as Q}from"./AccordianStyled-Bfci40yR.js";import{d as X}from"./ArrowCircleRightRounded-CHDn2dOA.js";import"./Card-B0aZ7mGs.js";function Z({Text1:t,Text2:i,confirmsg:a}){return e.jsx("div",{children:e.jsxs(I,{children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between"},pb:1,children:[e.jsxs(x,{children:[" ",e.jsx("b",{children:"Date : "})," ",t]}),e.jsx(x,{children:i===!0&&e.jsx("b",{children:"Claimed by Parent : Yes "})})]}),e.jsx(B,{onClick:a,children:"Cancel"})]})})}function ee({items:t}){return sessionStorage.getItem("Id"),e.jsx("div",{children:e.jsxs(I,{children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(x,{children:[" ",e.jsx("b",{children:"Date : "})," ",t.ReservationDate]}),e.jsxs(x,{children:[e.jsx("b",{children:"Claimed by Parent : "})," ",t.IsForParent===!0?"Yes":"No"]})]}),e.jsx(g,{sx:{display:"flex",justifyContent:"space-between"},pb:1,children:t.ClassNameDesignation!="-"?e.jsxs(x,{children:[" ",e.jsx("b",{children:" Class : "})," ",t.ClassNameDesignation]}):e.jsxs(x,{children:[e.jsx("b",{children:"Designation : "})," ",t.Designation]})})]})})}function se({expanded:t,handleChange:i,index:a,items:o,confirmsg:h}){const[c,l]=r.useState(!0);sessionStorage.getItem("Id");const j=E(),u=L();return e.jsx("div",{children:e.jsx(w,{in:c,style:{transformOrigin:"0 0 0"},...c?{timeout:1e3}:{},children:e.jsxs(P,{className:j.background,expanded:t===a,onChange:i(a),elevation:0,disableGutters:!0,children:[e.jsx(K,{expandIcon:e.jsx(Y,{sx:{color:"black"}}),"aria-controls":"panel1bh-content",id:"panel1bh-header",sx:{background:o.UserId==sessionStorage.getItem("Id")?"#c2dbff":`${u.colors.gradients.pink1}`},children:e.jsxs(Q,{color:t===a?"secondary":"",children:[e.jsx("b",{children:"Book Title : "})," ",o.Book_Title,e.jsxs(x,{children:[e.jsx("b",{children:"User Name : "})," ",o.UserName]})]})}),e.jsx(F,{children:o.UserId==sessionStorage.getItem("Id")?e.jsx(Z,{Text1:o.ReservationDate,Text2:o.IsForParent,confirmsg:h}):e.jsx(ee,{items:o})})]})})})}function te({clickSearch:t,clickAllUser:i}){r.useState(!0);const[a,o]=r.useState(""),[h,c]=r.useState(""),[l,j]=r.useState(!1),u=()=>{t({bookTitle:a,userName:h,AllUser:l})},f=n=>{j(n),i(n)},b=()=>{c(""),o("")};return e.jsx("div",{children:e.jsx(I,{children:e.jsxs(m,{container:!0,spacing:1,children:[e.jsx(m,{item:!0,xs:6,children:e.jsx(S,{id:"standard-basic",label:"Book Title :",variant:"standard",fullWidth:!0,value:a,onChange:n=>{o(n.target.value)}})}),e.jsx(m,{item:!0,xs:6,children:e.jsx(S,{id:"standard-basic",label:"User Name :",variant:"standard",fullWidth:!0,value:h,onChange:n=>{c(n.target.value)}})}),e.jsx(m,{item:!0,xs:11,children:e.jsx(B,{color:"secondary",onClick:b,children:"Reset"})}),e.jsx(m,{item:!0,xs:1,children:e.jsx(X,{onClick:u,fontSize:"large",color:"success",sx:{float:"right"}})}),e.jsx(m,{item:!0,xs:12,sx:{mt:"-10px"},children:e.jsx(G,{control:e.jsx(_,{checked:l,onChange:()=>{f(!l)}}),label:"Show all claimed books by all users"})})]})})})}function he(){const t=H(),i=k(s=>s.library.ClaimList),a=k(s=>s.library.CancelBookReservation),o=k(s=>s.library.Loading),[h,c]=O.useState(!1),[l,j]=r.useState(!1),[u,f]=r.useState(""),[b,n]=r.useState("");let C=i.filter(s=>l?!0:s.UserId===Number(sessionStorage.getItem("Id")));const v=sessionStorage.getItem("AcademicYearId"),N=localStorage.getItem("localSchoolId"),T=sessionStorage.getItem("Id"),p={aiSchoolId:N,aiAcademicYearId:v,aiUserId:T,asBookTitle:b,asUserName:u,aiStartRowIndex:"0",aiEndIndex:20,asSortExpression:"Order by Book_Title asc",aiAllUser:1};r.useEffect(()=>{t(y(p))},[b,u]),r.useEffect(()=>{a!==""&&$.success(a,{toastId:"success1"}),t(y(p)),t(M())},[a]);const U=s=>(d,R)=>{c(R?s:!1)},A=({bookTitle:s,userName:d})=>{n(s),f(d)},D=s=>{if(confirm("Are you sure you want to cancel the book claim?")){const d={aiUserId:sessionStorage.getItem("Id"),aiBookid:s,aiSchoolId:localStorage.getItem("localSchoolId"),aiAcademicYrId:sessionStorage.getItem("AcademicYearId")};t(z(d))}};return e.jsxs(g,{sx:{px:2},children:[e.jsx(J,{heading:"Claimed Books Details",subheading:""}),e.jsx(q,{FromRoute:"/Student/Library"}),e.jsx(te,{clickSearch:A,clickAllUser:s=>{j(s)}}),o?e.jsx(W,{}):C.length===0?e.jsx(V,{Error:l?"No record found":"No book has been claimed yet "}):C.map((s,d)=>e.jsx(g,{my:1,children:e.jsx(se,{expanded:h,handleChange:U,index:d,items:s,confirmsg:()=>{D(s.Book_Id)}})},d))]})}export{he as default};
