import{q as V,v as x,u as ce,A as W,r as s,z as de,c as p,cO as Ne,cP as ae,az as B,t as Y,cQ as Pe,ay as h,cR as Fe,cS as ue,cm as Le,cT as Me,cU as Be,j as e,G as u,o as Re,aH as R,aG as re,bs as Ue,T as Ge,n as _e,a6 as oe,ap as He,J as y,cV as ze,H as Oe,F as ie,au as Ye,K as Ve,C as We,cW as le,cX as Je,cY as Xe,B as O}from"./index-CpZD2H93.js";import{S as $e}from"./SingleFile-VnBjWcb-.js";import{S as qe}from"./SelectListHierarchy-B0--0w-H.js";import{H as Ke,U as Qe}from"./UploadAnnualPlanner-BebrWet5.js";import{T as Ze}from"./TabularList-BrAkDd2h.js";import"./CloudUpload-C2WsbpCZ.js";import"./Errormessage-DVJGTehf.js";const et=({EventId:r,AddNewEventClicked:m,SaveClicked:v})=>{let{SelectedDate:i,StandardId:n,DivisionId:l}=V();i=x(i),n=x(n),l=x(l);const o=ce(),I=W(),f=Number(localStorage.getItem("localSchoolId")),d=Number(sessionStorage.getItem("AcademicYearId")),E=localStorage.getItem("FolderName"),c=Number(sessionStorage.getItem("Id")),A=localStorage.getItem("TeacherId"),{showAlert:N,closeAlert:g}=s.useContext(de),U=["JPG","PNG","BMP","JPEG","PDF"],me=1e6,[G,w]=s.useState(""),[J,T]=s.useState(""),[D,P]=s.useState(null),[C,F]=s.useState(null),[b,L]=s.useState([]),[ve,_]=s.useState(!1),[X,Ee]=s.useState(""),[ge,Se]=s.useState(""),[$,q]=s.useState("");s.useState("");const[fe,K]=s.useState(""),[Q,k]=s.useState(""),[Z,j]=s.useState(""),[he,nt]=s.useState(""),ee={asSchoolId:f,asAcademicYearId:d,asEventId:r},xe=p(t=>t.EventsManagement.AllClassesAndDivisionss1),te=p(t=>t.EventsManagement.AllClassesAndDivisionss),H=p(t=>t.EventsManagement.SaveUpdateEventt),S=p(t=>t.EventsManagement.EventDetailss),z=p(t=>t.EventsManagement.DeleteEventImagee),Ie=t=>{L(t)},De=t=>{Ee(t.Name),Se(t.Value)};s.useEffect(()=>{M(),o(Ne({asSchoolId:f,asAcademicYearId:d}))},[]),s.useEffect(()=>{m>0&&M()},[m]),s.useEffect(()=>{v>0&&ne()},[v]),s.useEffect(()=>{r!=0&&o(ae(ee))},[r]),s.useEffect(()=>{S!==null?(w(S.Event_Name),T(S.Event_Description),P(B(S.Event_Start_Date)),F(B(S.Event_End_Date)),_(S.Display_On_Homepage=="True")):(r=0,w(""),T(""),P(B(i)),F(B(i)),_(!1),L(b.map(t=>({...t,IsActive:!1}))))},[S]),s.useEffect(()=>{L(te)},[te]),s.useEffect(()=>{H!==""&&(Y.success(H,{toastId:"success1"}),o(Pe()),M(),I("/RITeSchool/Common/AnnualPlanner/"+h(i)+"/"+h(n)+"/"+h(l),{state:{fromInternal:!0}}))},[H]);const se=t=>{if(!t)return!1;new Date(sessionStorage.getItem("StartDate")),new Date(sessionStorage.getItem("EndDate"));const a=new Date(t),ke=new Date("2024-04-01"),ye=new Date("2025-03-31");return a<ke||a>ye};s.useEffect(()=>{D&&C&&(Fe(D,C)?k("Start date should not be greater than end date."):se(D)?k("Event start date must be within current academic year (i.e between "+sessionStorage.getItem("StartDate")+" and "+sessionStorage.getItem("EndDate")+")."):k(""),se(C)?j("Event end date must be within current academic year (i.e between "+sessionStorage.getItem("StartDate")+" and "+sessionStorage.getItem("EndDate")+")."):j(""))},[D,C]);const M=()=>{o(ue()),r=0,w(""),T(""),P(null),F(null),_(!1),L(b.map(t=>({...t,IsActive:!1}))),k(""),j("")},Ce=()=>{let t="<StandardDivisions>";return Array.isArray(b)&&b.map(a=>{a.IsActive&&(t=t+' <Division StandardDivisionId="'+a.Id+'" />')}),t+="</StandardDivisions>",t},pe=()=>{let t=!1;return b.map(a=>{a.IsActive&&(t=!0)}),t},Ae=()=>{let t=!1;if(G==""?(q("Title should not be blank."),t=!0):q(""),D===""||D===null?(k("Start date should not be blank."),t=!0):Q!=""?t=!0:j(""),C===""||C===null?(j("End date should not be blank."),t=!0):Z!=""?t=!0:j(""),pe()?K(""):(K("At least one class should be associated."),t=!0),!t){const a={asEventId:r,asEventName:G,asEventDescription:J,asEventStartDate:D,asEventEndDate:C,asDisplayOnHomepage:ve,asEventImageName:X,asSchoolId:f,asAcademicYearId:d,asInsertedById:c.toString(),asUpdatedById:A,asStandardDivisions:Ce(),asSaveFeature:"Event Planner",asFolderName:E,asBase64String:ge};be(a)}},ne=()=>{N({title:"Please Confirm",message:"Are you sure you want to save event ?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{g()},onConfirm:()=>{Ae(),g()}})},be=s.useCallback(Le(t=>{o(Me(t))},500),[o]),je={asSchoolId:f,asAcademicYearId:d,asEventId:Number(r),asUserId:Number(c)},we=()=>{N({title:"Please Confirm",message:"Are you sure you want to delete event image ?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:g,onConfirm:()=>{o(ze(je)),g()}})};s.useEffect(()=>{z!=""&&(Y.success(z),o(Be()),o(ae(ee)))},[z]);const Te=()=>{window.open(localStorage.getItem("SiteURL")+"/RITeSchool/DOWNLOADS/Event Planner/"+S.Event_Image)};return e.jsx(e.Fragment,{children:e.jsxs(u,{container:!0,spacing:2,children:[e.jsxs(u,{xs:12,md:6,item:!0,children:[e.jsx(Re,{label:e.jsxs("span",{children:["Title ",e.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:1,value:G,onChange:t=>{const a=t.target.value;a===""?w(""):a.trim()!==""&&w(a)},fullWidth:!0,inputProps:{maxLength:100},sx:{resize:"both"}}),$&&e.jsx(R,{Error:$})]}),e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsx(re,{DateValue:D,onDateChange:P,label:"Start Date",size:"medium"}),e.jsx(R,{Error:Q})]}),e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsx(re,{DateValue:C,onDateChange:F,label:"End Date",size:"medium"}),e.jsx(R,{Error:Z})]}),e.jsx(u,{xs:12,md:12,item:!0,children:e.jsx(Ue,{label:e.jsxs("span",{children:["Description ",e.jsx("span",{style:{color:"red"}})]}),multiline:!0,rows:3,value:J,onChange:t=>{const a=t.target.value;a===""?T(""):a.trim()!==""&&T(a)},fullWidth:!0,sx:{resize:"both"}})}),e.jsxs(u,{item:!0,xs:12,md:12,children:[e.jsx(qe,{ItemList:b,ParentList:xe,ClickChild:Ie}),e.jsx(R,{Error:fe})]}),e.jsxs(u,{container:!0,xs:6,md:6,item:!0,children:[e.jsx(Ge,{fontSize:"10px",pt:1,pr:3,ml:2,children:"Select Photo:"}),e.jsx(u,{item:!0,sx:{pl:{xs:2,md:0}},children:e.jsx($e,{ValidFileTypes:U,MaxfileSize:me,ChangeFile:De,errorMessage:he,FilePath:S==null?"":S.Event_Image,FileName:X,viewIcon:!0,deleteIcon:!0,clickFileName:Te,clickDelete:we,isMandatory:!1})})]}),e.jsx(u,{item:!0,xs:12,md:12,children:e.jsxs(_e,{direction:"row",gap:2,alignItems:"center",children:[e.jsx(oe,{onClick:M,sx:{color:"red",":hover":{backgroundColor:He[100]}},children:"Clear"}),e.jsx(oe,{onClick:ne,sx:{color:"green",":hover":{backgroundColor:y[100]}},children:"Save"})]})})]})})},tt=({ClickAddNewEvent:r,ClickSave:m})=>{const v=W();let{SelectedDate:i,StandardId:n,DivisionId:l}=V();i=x(i),n=x(n),l=x(l);const[o,I]=s.useState(!1),d=[{Id:2,Icon:e.jsx(Oe,{}),Title:"        Event management for your school. Add events to be held in your school for the current academic year.",Action:"Help",sx:{color:"white",backgroundColor:ie[500],"&:hover":{backgroundColor:ie[600]}}},{Id:4,Icon:e.jsx(Ye,{}),Title:"Add New Event",Action:"AddNewEvent",sx:{color:"white",backgroundColor:y[500],"&:hover":{backgroundColor:y[600]}}},{Id:3,Icon:e.jsx(Ve,{}),Title:"Save",Action:"Save",sx:{color:"white",backgroundColor:y[500],"&:hover":{backgroundColor:y[600]}}}],E=c=>{c=="EventsOverview"&&v("/RITeSchool/Common/EventOverview",{state:{fromInternal:!0}}),c=="Save"&&m(),c=="AddNewEvent"&&r()};return""+h(i)+h(n)+h(l),e.jsxs(e.Fragment,{children:[e.jsx(We,{navLinks:[{title:"Annual Planner",path:"/RITeSchool/Common/AnnualPlanner/"+h(i)+"/"+h(n)+"/"+h(l)},{title:"Event(s) Management",path:""}],rightActions:e.jsx(e.Fragment,{children:e.jsx(Ke,{IconList:d,ClickIcon:E})})}),o&&e.jsx(Qe,{openAnnualPlannerDialog:o,setOpenAnnualPlannerDialog:I})]})},st=({clickEventEdit:r,SelectedDate:m,StandardId:v,DivisionId:i})=>{W();const n=ce(),l=Number(localStorage.getItem("localSchoolId")),o=Number(sessionStorage.getItem("AcademicYearId")),I=Number(sessionStorage.getItem("Id")),{showAlert:f,closeAlert:d}=s.useContext(de),E=p(g=>g.EventsManagement.EventListt),c=p(g=>g.EventsManagement.DeleteEventt),A={asEventDate:m,asSchoolId:l,asAcademicYearId:o,asStandardId:v,asDivisionId:i};s.useEffect(()=>{n(le(A))},[]),s.useEffect(()=>{E.length>0&&r(E[0].Id)},[E]),s.useEffect(()=>{c!==""&&(Y.success(c,{toastId:"success1"}),n(Je()),n(le(A)),n(ue()))},[c]);const N=g=>{const U={asSchoolId:l,asEventId:Number(g),asUserId:Number(I)};f({title:"Please Confirm",message:"Are you sure you want to delete the event?  ",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{d()},onConfirm:()=>{n(Xe(U)),d()}})};return e.jsx(u,{container:!0,spacing:2,pb:1,children:e.jsx(u,{item:!0,xs:12,children:e.jsx(Ze,{ItemList:E,clickEdit:r,clickDelete:N})})})},ut=()=>{let{SelectedDate:r,StandardId:m,DivisionId:v}=V();r=x(r),m=x(m),v=x(v);const[i,n]=s.useState(0),[l,o]=s.useState(0),[I,f]=s.useState(0),d=A=>{n(A)},E=()=>{f(I+1)},c=()=>{o(l+1),n(0)};return e.jsx(e.Fragment,{children:e.jsxs(O,{sx:{px:2},children:[e.jsx(tt,{ClickAddNewEvent:c,ClickSave:E}),e.jsx(O,{sx:{backgroundColor:"white"},p:2,children:e.jsxs(O,{mt:1.5,sx:{backgroundColor:"white"},children:[e.jsx(st,{clickEventEdit:d,SelectedDate:r,StandardId:m,DivisionId:v}),e.jsx(et,{EventId:i,AddNewEventClicked:l,SaveClicked:I})]})})]})})};export{ut as default};
